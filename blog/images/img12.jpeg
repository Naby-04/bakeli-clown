<!DOCTYPE html><html lang="en" class=""><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="canonical" href="https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz"/><title>Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)</title><meta name="description" content="Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.
writing an API that will be consumed by other people needs to be written in a way that caters to everyone&#x27;s needs.
I picked the tickets to work on fo..."/><meta property="og:title" content="Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)"/><meta property="og:description" content="Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.
writing an API that will be consumed by other people needs to be written in a way that caters to everyone&#x27;s needs.
I picked the tickets to work on fo..."/><meta property="og:site_name" content="Fawas Tech Blog"/><meta property="og:type" content="article"/><meta property="og:url" content="https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz"/><meta name="image" property="og:image" content="https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1597498125763%2FwDrH2aIEy.png%3Fw%3D1200%26h%3D630%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp%26fm%3Dpng"/><meta name="author" content="Fawas Kareem"/><meta property="article:author" content="https://hashnode.com/@Phawazzzy"/><link rel="author" href="https://hashnode.com/@Phawazzzy"/><link rel="apple-touch-icon" sizes="180x180" href="https://cdn.hashnode.com/res/hashnode/image/upload/v1611242155728/W3_BYVVVh.png"/><link rel="icon" type="image/png" sizes="32x32" href="https://cdn.hashnode.com/res/hashnode/image/upload/v1611242173172/AOX1gE2jc.png"/><link rel="icon" type="image/png" sizes="16x16" href="https://cdn.hashnode.com/res/hashnode/image/upload/v1611242187756/TRTNYp32O.png"/><link rel="mask-icon" href="/static/images/brand/safari-pinned-tab-new.svg" color="#2962ff"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="theme-color" content="#f6f7fb"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:title" content="Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)"/><meta property="twitter:description" content="Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.
writing an API that will be consumed by other people needs to be written in a way that caters to everyone&#x27;s needs.
I picked the tickets to work on fo..."/><meta property="twitter:image" content="https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1597498125763%2FwDrH2aIEy.png%3Fw%3D1200%26h%3D630%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp%26fm%3Dpng"/><style>/* Monkai theme */
          .hljs{display:block;overflow-x:auto;padding:.5em;background:#23241f}.hljs,.hljs-subst,.hljs-tag{color:#f8f8f2}.hljs-emphasis,.hljs-strong{color:#a8a8a2}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ae81ff}.hljs-code,.hljs-section,.hljs-selector-class,.hljs-title{color:#a6e22e}.hljs-strong{font-weight:700}.hljs-emphasis{font-style:italic}.hljs-attr,.hljs-keyword,.hljs-name,.hljs-selector-tag{color:#f92672}.hljs-attribute,.hljs-symbol{color:#66d9ef}.hljs-class .hljs-title,.hljs-params{color:#f8f8f2}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-string,.hljs-template-variable,.hljs-type,.hljs-variable{color:#e6db74}.hljs-comment,.hljs-deletion,.hljs-meta{color:#75715e}
            /* Monkai theme ends */</style><link rel="alternate" type="application/rss+xml" title="RSS Feed for Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)" href="https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz/rss.xml"/><link rel="preload" as="image" href="https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg?w=400&amp;h=400&amp;fit=crop&amp;crop=faces&amp;auto=compress,format&amp;format=webp"/><link rel="preload" as="image" href="https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png?w=1600&amp;h=840&amp;fit=crop&amp;crop=entropy&amp;auto=compress,format&amp;format=webp"/><meta name="next-head-count" content="28"/><style>#nprogress{pointer-events:none}#nprogress .bar{background:#29d;position:fixed;z-index:1031;top:0;left:0;width:100%;height:2px}#nprogress .peg{display:block;position:absolute;right:0;width:100px;height:100%;box-shadow:0 0 10px #29d,0 0 5px #29d;opacity:1;-webkit-transform:rotate(3deg) translate(0,-4px);-ms-transform:rotate(3deg) translate(0,-4px);transform:rotate(3deg) translate(0,-4px)}#nprogress .spinner{display:block;position:fixed;z-index:1031;top:15px;right:15px}#nprogress .spinner-icon{width:18px;height:18px;box-sizing:border-box;border:solid 2px transparent;border-top-color:#29d;border-left-color:#29d;border-radius:50%;-webkit-animation:nprogress-spinner .4s linear infinite;animation:nprogress-spinner .4s linear infinite}.nprogress-custom-parent{overflow:hidden;position:relative}.nprogress-custom-parent #nprogress .bar,.nprogress-custom-parent #nprogress .spinner{position:absolute}@-webkit-keyframes nprogress-spinner{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(360deg)}}@keyframes nprogress-spinner{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}</style><script async="" src="https://ping.hashnode.com/gtag/js?id=G-72XG3F8LNJ"></script><script type="text/javascript">
    window.dataLayer = window.dataLayer || [];
    function gtag(){window.dataLayer.push(arguments);}
    gtag('js', new Date());
  </script><link rel="preload" href="/_next/static/media/c9a5bc6a7c948fb0-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/0f259f6e208ee521.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0f259f6e208ee521.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script defer="" src="/_next/static/chunks/8820-56721d947d773244.js"></script><script defer="" src="/_next/static/chunks/7726.745bb052814a0014.js"></script><script defer="" src="/_next/static/chunks/7138-e9192a513cd7fe3c.js"></script><script defer="" src="/_next/static/chunks/7179.1bbe30751443d39c.js"></script><script src="/_next/static/chunks/webpack-a66637d8dbe235da.js" defer=""></script><script src="/_next/static/chunks/framework-ce84985cd166733a.js" defer=""></script><script src="/_next/static/chunks/main-f01607ca6b9a38ef.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6bdeb507484e42b5.js" defer=""></script><script src="/_next/static/chunks/924-a8d8e671eeba6085.js" defer=""></script><script src="/_next/static/chunks/6933-2162f925a386048e.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-7fdcf389d30f97a0.js" defer=""></script><script src="/_next/static/Z3LCGys0VVvSnYg5jJZcd/_buildManifest.js" defer=""></script><script src="/_next/static/Z3LCGys0VVvSnYg5jJZcd/_ssgManifest.js" defer=""></script><style id="__jsx-2617157637">@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Book-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Book-WebXL.woff")format("woff");font-weight:450;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Medium-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Medium-WebXL.woff")format("woff");font-weight:500;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-SemiBold-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-SemiBold-WebXL.woff")format("woff");font-weight:600;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Bold-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Bold-WebXL.woff")format("woff");font-weight:700;font-style:normal;font-display:block}html{--font-inter:__Inter_d9825c;--font-suisse-intl:'Suisse Intl'}</style></head><body class="bg-white leading-normal antialiased dark:bg-slate-950"><input type="hidden" id="hn-user"/><style id="__jsx-2617157637">@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Book-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Book-WebXL.woff")format("woff");font-weight:450;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Medium-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Medium-WebXL.woff")format("woff");font-weight:500;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-SemiBold-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-SemiBold-WebXL.woff")format("woff");font-weight:600;font-style:normal;font-display:block}@font-face{font-family:"Suisse Intl";src:url("/fonts/SuisseIntl-Bold-WebXL.woff2")format("woff2"),url("/fonts/SuisseIntl-Bold-WebXL.woff")format("woff");font-weight:700;font-style:normal;font-display:block}html{--font-inter:__Inter_d9825c;--font-suisse-intl:'Suisse Intl'}</style><div id="__next"><div class="bg-white dark:bg-slate-950" data-theme="light"><script type="application/ld+json">{"@context":"https://schema.org","@type":"NewsArticle","url":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz","mainEntityOfPage":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz","headline":"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)","description":"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\nI picked the tickets to work on fo...","datePublished":"2020-08-15T13:47:17.576Z","dateModified":"2020-08-16T16:52:37.855Z","isAccessibleForFree":true,"author":{"@type":"Person","name":"Fawas Kareem","url":"https://hashnode.com/@Phawazzzy"},"publisher":{"@type":"Organization","name":"Fawas Tech Blog","url":"https://fawaskareem.hashnode.dev","logo":"https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1559814205701%2Fek9fO-yT0.jpeg%3Fw%3D800%26bm%3Dnormal%26balph%3D100%26txt64%3DRmF3YXMgVGVjaCBCbG9n%26txtsize%3D42%26txtfit%3Dmax%26txtalign%3Dmiddle%2Ccenter%26txtfont%3DHelvetica%20Neue%2CBold%26txtclr%3D000000%26blend%3Dffffff"},"image":{"@type":"ImageObject","url":"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png"}}</script><header class="blog-header z-50 w-full border-b relative transform-none md:sticky md:top-0 md:left-0 md:backdrop-blur-lg border-black/10 bg-white bg-opacity-70 dark:border-white/10 dark:bg-slate-900 dark:bg-opacity-70"><div class="container mx-auto px-2 md:px-4 md:py-1 2xl:px-10"><div class="relative z-40 flex flex-row items-center justify-between pb-2 pt-8 md:py-4"><div class="mb-2 flex flex-row items-center md:mb-0 dark:text-white"><a aria-label="Back to blog home" class="blog-back-to-home-button focus-ring-base flex flex-row items-center rounded-full font-medium transition duration-100 ease-in-out focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20 mr-2 p-3" data-state="closed" href="/"><svg class="h-4 w-4 fill-current pr-1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 10 17"><path d="M7.75135 16.7197L0.885098 9.55347C0.683348 9.31347 0.600098 9.08847 0.600098 8.89722C0.600098 8.70597 0.68331 8.44834 0.850898 8.27509L7.71715 1.10884C8.06035 0.749066 8.6299 0.737366 8.9884 1.08189C9.34933 1.42408 9.36107 1.99576 9.01535 2.35351L2.7466 8.89722L9.0466 15.4747C9.39231 15.831 9.38057 16.404 9.01965 16.7463C8.6626 17.091 8.0926 17.0797 7.75135 16.7197Z"></path></svg></a><div class="mr-2"><button type="button" aria-label="Open blog links" class="blog-bars-button focus-ring-base flex flex-row items-center rounded-full font-medium transition duration-100 ease-in-out focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20 mr-2 p-2" data-state="closed"><svg class="h-6 w-6 stroke-current" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.9889 11.9969H11.9945H3M20.9889 17.8745H3M21 6.12451H3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><div class="hidden md:block"><h1 class="blog-title text-lg md:text-xl text-left break-words font-heading font-semibold leading-snug md:font-bold dark:text-white"><a href="/?source=top_nav_blog_home" class="focus-ring-base flex flex-row items-center focus-ring-colors-base" aria-label="Fawas Tech Blog home page"><div class="mr-2 h-10 w-10 shrink-0 overflow-hidden rounded-full"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27400%27%20height=%27400%27/%3e"/></span><img alt="Fawas Kareem" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg?w=400&amp;h=400&amp;fit=crop&amp;crop=faces&amp;auto=compress,format&amp;format=webp" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/></span></div>Fawas Tech Blog</a></h1></div></div><div class="flex flex-row items-center dark:text-white"><button type="button" aria-label="Open blog search" class="blog-search-button focus-ring-base flex flex-row items-center rounded-full font-medium transition duration-100 ease-in-out focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20 mr-2 p-2" data-state="closed"><svg class="h-6 w-6 stroke-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path d="M21 21L15.8091 15.8091M18 10.5C18 14.6421 14.6421 18 10.5 18C6.35786 18 3 14.6421 3 10.5C3 6.35786 6.35786 3 10.5 3C14.6421 3 18 6.35786 18 10.5Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><button type="button" aria-label="Toggle blog theme" class="blog-theme-switcher focus-ring-base flex flex-row items-center rounded-full font-medium transition duration-100 ease-in-out focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20 mr-2 p-2" data-state="closed"><svg class="h-6 w-6 stroke-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path d="M3 11.4489C3 16.7238 7.16904 21 12.3118 21C16.2709 21 19.6529 18.4657 21 14.8925C19.9331 15.4065 18.7418 15.6938 17.485 15.6938C12.9137 15.6938 9.20787 11.8928 9.20787 7.20396C9.20787 5.24299 9.85605 3.4373 10.9446 2C6.45002 2.6783 3 6.65034 3 11.4489Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button><div class="hidden md:mr-2 md:block"><div class="flex animate-pulse flex-row items-center rounded-full border-1-1/2 px-4 py-2 text-center text-sm font-medium bg-slate-100 dark:border-slate-900 dark:bg-slate-800"><svg class="invisible mr-2 h-5 w-5" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.2953 4.58698C13.9301 4.37611 13.683 4.00814 13.626 3.59028L13.4336 2.17939C13.3415 1.50373 12.7644 1 12.0825 1L9.91765 1C9.23573 1 8.65865 1.50373 8.56652 2.17939L8.37412 3.5903C8.31709 4.00849 8.06963 4.37672 7.70395 4.58749L7.0923 4.94003C6.72723 5.15046 6.28538 5.18029 5.89533 5.02084L4.57791 4.48227C3.9467 4.22423 3.22192 4.47214 2.88096 5.06269L1.79854 6.9375C1.45758 7.52805 1.60528 8.27969 2.14436 8.69731L3.26948 9.56895C3.60259 9.82701 3.79768 10.2246 3.79799 10.646L3.7985 11.3519C3.7988 11.774 3.60364 12.1724 3.26999 12.4309L2.14433 13.3029C1.60525 13.7205 1.45755 14.4722 1.79851 15.0627L2.88093 16.9375C3.22189 17.5281 3.94667 17.776 4.57788 17.518L5.89588 16.9792C6.28624 16.8196 6.72847 16.8496 7.0937 17.0604L7.70483 17.4133C8.07006 17.6241 8.31718 17.9921 8.37416 18.41L8.56652 19.8206C8.65865 20.4963 9.23573 21 9.91765 21L12.0825 21C12.7644 21 13.3415 20.4963 13.4336 19.8206L13.626 18.4098C13.683 17.9916 13.9305 17.6234 14.2962 17.4127L14.9077 17.0602C15.2728 16.8497 15.7146 16.8199 16.1047 16.9794L17.4221 17.5179C18.0533 17.776 18.7781 17.5281 19.119 16.9375L20.2015 15.0627C20.5424 14.4721 20.3947 13.7205 19.8557 13.3029L18.7305 12.4312C18.3974 12.1732 18.2023 11.7756 18.202 11.3542L18.2015 10.6483C18.2012 10.2263 18.3964 9.82784 18.73 9.56935L19.8556 8.69734C20.3947 8.27972 20.5424 7.52809 20.2014 6.93753L19.119 5.06272C18.7781 4.47217 18.0533 4.22427 17.4221 4.48231L16.1042 5.02106C15.7138 5.18064 15.2716 5.15063 14.9064 4.93976L14.2953 4.58698Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M13.3619 12.3637C12.6088 13.6681 10.9408 14.1151 9.63638 13.362C8.33195 12.6088 7.88502 10.9409 8.63813 9.63643C9.39125 8.33199 11.0592 7.88506 12.3637 8.63818C13.6681 9.39129 14.115 11.0593 13.3619 12.3637Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="invisible">Follow</span></div></div><div class="hidden md:mr-2 md:block"><div class="animate-pulse rounded-full border-1-1/2 p-2 bg-slate-100 dark:border-slate-900 dark:bg-slate-800"><svg class="invisible h-5 w-5" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.1728 3.50973C12.587 3.50973 12.9228 3.17395 12.9228 2.75973C12.9228 2.34552 12.587 2.00973 12.1728 2.00973V3.50973ZM18.958 9.10996C18.958 8.69575 18.6222 8.35996 18.208 8.35996C17.7938 8.35996 17.458 8.69575 17.458 9.10996H18.958ZM1.5018 5.97023C1.1338 5.7801 0.681352 5.9243 0.491222 6.2923C0.301092 6.66029 0.445283 7.11275 0.813283 7.30288L1.5018 5.97023ZM15.6397 8.12794C15.9841 7.8979 16.0769 7.43217 15.8468 7.08771C15.6168 6.74325 15.1511 6.6505 14.8066 6.88055L15.6397 8.12794ZM7.29742 9.80877L6.95316 10.4751L7.29742 9.80877ZM9.154 10.5963L9.2714 9.85557L9.154 10.5963ZM12.1823 9.53509L11.7658 8.91139L12.1823 9.53509ZM10.4253 10.5251L10.2259 9.80209L10.4253 10.5251ZM16.1797 3.11305C15.8868 2.82016 15.4119 2.82016 15.1191 3.11305C14.8262 3.40595 14.8262 3.88082 15.1191 4.17371L16.1797 3.11305ZM17.3215 5.31545L16.7911 5.84578C16.9358 5.99043 17.1332 6.06972 17.3377 6.06527C17.5423 6.06083 17.7361 5.97304 17.8743 5.82224L17.3215 5.31545ZM21.5529 1.80928C21.8328 1.50394 21.8121 1.02952 21.5068 0.749625C21.2015 0.46973 20.727 0.490357 20.4471 0.795697L21.5529 1.80928ZM17.458 14.2317C17.458 14.8735 16.9378 15.3937 16.296 15.3937V16.8937C17.7662 16.8937 18.958 15.7019 18.958 14.2317H17.458ZM16.296 15.3937H2.912V16.8937H16.296V15.3937ZM2.912 15.3937C2.27025 15.3937 1.75 14.8735 1.75 14.2317H0.25C0.25 15.7019 1.44182 16.8937 2.912 16.8937V15.3937ZM1.75 14.2317V4.67173H0.25V14.2317H1.75ZM1.75 4.67173C1.75 4.02998 2.27024 3.50973 2.912 3.50973V2.00973C1.44182 2.00973 0.25 3.20155 0.25 4.67173H1.75ZM2.912 3.50973H12.1728V2.00973H2.912V3.50973ZM18.958 14.2317V9.10996H17.458V14.2317H18.958ZM0.813283 7.30288L6.95316 10.4751L7.64168 9.14245L1.5018 5.97023L0.813283 7.30288ZM12.5988 10.1588L15.6397 8.12794L14.8066 6.88055L11.7658 8.91139L12.5988 10.1588ZM6.95316 10.4751C7.82539 10.9257 8.40949 11.2377 9.03661 11.3371L9.2714 9.85557C8.93995 9.80304 8.60585 9.6406 7.64168 9.14245L6.95316 10.4751ZM11.7658 8.91139C10.8633 9.51412 10.5494 9.71287 10.2259 9.80209L10.6247 11.2481C11.2368 11.0793 11.7824 10.704 12.5988 10.1588L11.7658 8.91139ZM9.03661 11.3371C9.56626 11.421 10.1077 11.3907 10.6247 11.2481L10.2259 9.80209C9.91519 9.88779 9.58974 9.90602 9.2714 9.85557L9.03661 11.3371ZM15.1191 4.17371L16.7911 5.84578L17.8518 4.78512L16.1797 3.11305L15.1191 4.17371ZM17.8743 5.82224L21.5529 1.80928L20.4471 0.795697L16.7686 4.80866L17.8743 5.82224Z"></path></svg></div></div><div class="h-10 w-10 animate-pulse rounded-full border-1-1/2 bg-slate-100 dark:border-slate-900 dark:bg-slate-800"></div></div></div><div class="mx-auto my-5 flex w-2/3 flex-row items-center justify-center md:hidden"><h1 class="blog-title text-2xl text-center break-words font-heading font-semibold leading-snug md:font-bold dark:text-white"><a href="/?source=top_nav_blog_home" class="focus-ring-base flex flex-row items-center focus-ring-colors-base" aria-label="Fawas Tech Blog home page">Fawas Tech Blog</a></h1></div><div class="blog-sub-header mb-4 md:hidden" data-testid="blog-sub-header"><div class="md:(mb-0 ml-auto) flex flex-row items-center justify-center gap-x-3"><div class="flex animate-pulse flex-row items-center rounded-full border-1-1/2 px-4 py-2 text-center text-sm font-medium bg-slate-100 dark:border-slate-900 dark:bg-slate-800"><svg class="invisible mr-2 h-5 w-5" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.2953 4.58698C13.9301 4.37611 13.683 4.00814 13.626 3.59028L13.4336 2.17939C13.3415 1.50373 12.7644 1 12.0825 1L9.91765 1C9.23573 1 8.65865 1.50373 8.56652 2.17939L8.37412 3.5903C8.31709 4.00849 8.06963 4.37672 7.70395 4.58749L7.0923 4.94003C6.72723 5.15046 6.28538 5.18029 5.89533 5.02084L4.57791 4.48227C3.9467 4.22423 3.22192 4.47214 2.88096 5.06269L1.79854 6.9375C1.45758 7.52805 1.60528 8.27969 2.14436 8.69731L3.26948 9.56895C3.60259 9.82701 3.79768 10.2246 3.79799 10.646L3.7985 11.3519C3.7988 11.774 3.60364 12.1724 3.26999 12.4309L2.14433 13.3029C1.60525 13.7205 1.45755 14.4722 1.79851 15.0627L2.88093 16.9375C3.22189 17.5281 3.94667 17.776 4.57788 17.518L5.89588 16.9792C6.28624 16.8196 6.72847 16.8496 7.0937 17.0604L7.70483 17.4133C8.07006 17.6241 8.31718 17.9921 8.37416 18.41L8.56652 19.8206C8.65865 20.4963 9.23573 21 9.91765 21L12.0825 21C12.7644 21 13.3415 20.4963 13.4336 19.8206L13.626 18.4098C13.683 17.9916 13.9305 17.6234 14.2962 17.4127L14.9077 17.0602C15.2728 16.8497 15.7146 16.8199 16.1047 16.9794L17.4221 17.5179C18.0533 17.776 18.7781 17.5281 19.119 16.9375L20.2015 15.0627C20.5424 14.4721 20.3947 13.7205 19.8557 13.3029L18.7305 12.4312C18.3974 12.1732 18.2023 11.7756 18.202 11.3542L18.2015 10.6483C18.2012 10.2263 18.3964 9.82784 18.73 9.56935L19.8556 8.69734C20.3947 8.27972 20.5424 7.52809 20.2014 6.93753L19.119 5.06272C18.7781 4.47217 18.0533 4.22427 17.4221 4.48231L16.1042 5.02106C15.7138 5.18064 15.2716 5.15063 14.9064 4.93976L14.2953 4.58698Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M13.3619 12.3637C12.6088 13.6681 10.9408 14.1151 9.63638 13.362C8.33195 12.6088 7.88502 10.9409 8.63813 9.63643C9.39125 8.33199 11.0592 7.88506 12.3637 8.63818C13.6681 9.39129 14.115 11.0593 13.3619 12.3637Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="invisible">Follow</span></div><div class="animate-pulse rounded-full border-1-1/2 p-2 bg-slate-100 dark:border-slate-900 dark:bg-slate-800"><svg class="invisible h-5 w-5" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.1728 3.50973C12.587 3.50973 12.9228 3.17395 12.9228 2.75973C12.9228 2.34552 12.587 2.00973 12.1728 2.00973V3.50973ZM18.958 9.10996C18.958 8.69575 18.6222 8.35996 18.208 8.35996C17.7938 8.35996 17.458 8.69575 17.458 9.10996H18.958ZM1.5018 5.97023C1.1338 5.7801 0.681352 5.9243 0.491222 6.2923C0.301092 6.66029 0.445283 7.11275 0.813283 7.30288L1.5018 5.97023ZM15.6397 8.12794C15.9841 7.8979 16.0769 7.43217 15.8468 7.08771C15.6168 6.74325 15.1511 6.6505 14.8066 6.88055L15.6397 8.12794ZM7.29742 9.80877L6.95316 10.4751L7.29742 9.80877ZM9.154 10.5963L9.2714 9.85557L9.154 10.5963ZM12.1823 9.53509L11.7658 8.91139L12.1823 9.53509ZM10.4253 10.5251L10.2259 9.80209L10.4253 10.5251ZM16.1797 3.11305C15.8868 2.82016 15.4119 2.82016 15.1191 3.11305C14.8262 3.40595 14.8262 3.88082 15.1191 4.17371L16.1797 3.11305ZM17.3215 5.31545L16.7911 5.84578C16.9358 5.99043 17.1332 6.06972 17.3377 6.06527C17.5423 6.06083 17.7361 5.97304 17.8743 5.82224L17.3215 5.31545ZM21.5529 1.80928C21.8328 1.50394 21.8121 1.02952 21.5068 0.749625C21.2015 0.46973 20.727 0.490357 20.4471 0.795697L21.5529 1.80928ZM17.458 14.2317C17.458 14.8735 16.9378 15.3937 16.296 15.3937V16.8937C17.7662 16.8937 18.958 15.7019 18.958 14.2317H17.458ZM16.296 15.3937H2.912V16.8937H16.296V15.3937ZM2.912 15.3937C2.27025 15.3937 1.75 14.8735 1.75 14.2317H0.25C0.25 15.7019 1.44182 16.8937 2.912 16.8937V15.3937ZM1.75 14.2317V4.67173H0.25V14.2317H1.75ZM1.75 4.67173C1.75 4.02998 2.27024 3.50973 2.912 3.50973V2.00973C1.44182 2.00973 0.25 3.20155 0.25 4.67173H1.75ZM2.912 3.50973H12.1728V2.00973H2.912V3.50973ZM18.958 14.2317V9.10996H17.458V14.2317H18.958ZM0.813283 7.30288L6.95316 10.4751L7.64168 9.14245L1.5018 5.97023L0.813283 7.30288ZM12.5988 10.1588L15.6397 8.12794L14.8066 6.88055L11.7658 8.91139L12.5988 10.1588ZM6.95316 10.4751C7.82539 10.9257 8.40949 11.2377 9.03661 11.3371L9.2714 9.85557C8.93995 9.80304 8.60585 9.6406 7.64168 9.14245L6.95316 10.4751ZM11.7658 8.91139C10.8633 9.51412 10.5494 9.71287 10.2259 9.80209L10.6247 11.2481C11.2368 11.0793 11.7824 10.704 12.5988 10.1588L11.7658 8.91139ZM9.03661 11.3371C9.56626 11.421 10.1077 11.3907 10.6247 11.2481L10.2259 9.80209C9.91519 9.88779 9.58974 9.90602 9.2714 9.85557L9.03661 11.3371ZM15.1191 4.17371L16.7911 5.84578L17.8518 4.78512L16.1797 3.11305L15.1191 4.17371ZM17.8743 5.82224L21.5529 1.80928L20.4471 0.795697L16.7686 4.80866L17.8743 5.82224Z"></path></svg></div></div><div class="mt-6"><div class="blog-social-media-section flex flex-row flex-wrap gap-y-2 justify-center gap-x-1.5 text-slate-700 dark:text-slate-300"><a href="https://twitter.com/@fawas_ola" aria-label="Find me on Twitter, external website, opens in new tab" target="_blank" rel="me noopener" class="focus-ring-base flex flex-row items-center justify-center rounded-full p-2 transition-colors duration-150 focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20"><svg class="h-5 w-5 stroke-current" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.643 13.346L4.26862 4.86856C3.85863 4.32329 4.2478 3.54408 4.93001 3.54431L7.2184 3.54508C7.47633 3.54517 7.71945 3.66557 7.87585 3.87066L12.9065 10.4675M10.643 13.346L5.19311 20.5093M10.643 13.346L15.8028 20.077C15.9588 20.2805 16.2003 20.4001 16.4567 20.4009L18.7925 20.4082C19.4778 20.4104 19.8683 19.6261 19.4536 19.0805L12.9065 10.4675M12.9065 10.4675L18.2181 3.50928" stroke-width="1.5" stroke-linecap="round"></path></svg></a><a href="https://github.com/phawazzzy" aria-label="Find me on Github, opens in new tab" target="_blank" rel="me noopener" class="focus-ring-base flex flex-row items-center justify-center rounded-full p-2 transition-colors duration-150 focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20"><svg class="h-5 w-5 fill-current" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://github.com/phawazzzy" aria-label="Check out my website, external website, opens in new tab" target="_blank" rel="me noopener" class="focus-ring-base flex flex-row items-center justify-center rounded-full p-2 transition-colors duration-150 focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20"><svg class="h-5 w-5 fill-current" viewBox="0 0 24 24"><path d="M17.9 17.39c-.26-.8-1.01-1.39-1.9-1.39h-1v-3a1 1 0 0 0-1-1H8v-2h2a1 1 0 0 0 1-1V7h2a2 2 0 0 0 2-2v-.41c2.93 1.18 5 4.05 5 7.41 0 2.08-.8 3.97-2.1 5.39M11 19.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.22.21-1.79L9 15v1a2 2 0 0 0 2 2m1-16A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2z"></path></svg></a><a href="https://hashnode.com/@Phawazzzy" aria-label="Find me on Hashnode, external website, opens in new tab" target="_blank" rel="me noopener" class="focus-ring-base flex flex-row items-center justify-center rounded-full p-2 transition-colors duration-150 focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20"><svg class="h-5 w-5 fill-current" viewBox="0 0 200 200" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.742 66.824c-18.323 18.323-18.323 48.029 0 66.352l53.082 53.082c18.323 18.323 48.029 18.323 66.352 0l53.082-53.082c18.323-18.323 18.323-48.03 0-66.352l-53.082-53.082c-18.323-18.323-48.03-18.323-66.352 0L13.742 66.824zm109.481 56.399c12.826-12.826 12.826-33.62 0-46.446s-33.62-12.826-46.446 0-12.826 33.62 0 46.446 33.62 12.826 46.446 0z"></path></svg></a><a href="/rss.xml" aria-label="Open blog XML Feed, opens in new tab" target="_blank" rel="me noopener" class="focus-ring-base flex flex-row items-center justify-center rounded-full p-2 transition-colors duration-150 focus-ring-colors-base hover:bg-black/10 dark:hover:bg-white/20"><svg class="h-5 w-5 fill-current" viewBox="0 0 448 512"><path d="M80 368c17.645 0 32 14.355 32 32s-14.355 32-32 32-32-14.355-32-32 14.355-32 32-32m0-48c-44.183 0-80 35.817-80 80s35.817 80 80 80 80-35.817 80-80-35.817-80-80-80zm367.996 147.615c-6.449-237.834-198.057-429.163-435.61-435.61C5.609 31.821 0 37.229 0 44.007v24.02c0 6.482 5.147 11.808 11.626 11.992 211.976 6.04 382.316 176.735 388.354 388.354.185 6.479 5.51 11.626 11.992 11.626h24.02c6.78.001 12.187-5.608 12.004-12.384zm-136.239-.05C305.401 305.01 174.966 174.599 12.435 168.243 5.643 167.977 0 173.444 0 180.242v24.024c0 6.431 5.072 11.705 11.497 11.98 136.768 5.847 246.411 115.511 252.258 252.258.275 6.425 5.549 11.497 11.98 11.497h24.024c6.797-.001 12.264-5.644 11.998-12.436z"></path></svg></a></div></div></div></div></header><div class="blog-post-area relative z-40"><main class="blog-post-detail-card pb-24"><article><div class="blog-article-page container relative mx-auto grid grid-cols-8"><div class="col-span-full lg:col-span-6 lg:col-start-2"><div class="relative"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;padding-top:52.5%"></span><img alt="Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png?w=1600&amp;h=840&amp;fit=crop&amp;crop=entropy&amp;auto=compress,format&amp;format=webp" decoding="async" data-nimg="responsive" class="mb-0 block w-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;background-size:cover;background-position:0% 0%;filter:blur(20px);background-image:url(&quot;https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png?w=400&amp;h=210&amp;fit=crop&amp;crop=entropy&amp;auto=compress,format&amp;format=webp&amp;fm=blurhash&quot;)"/><noscript><img alt="Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)" decoding="async" data-nimg="responsive" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="mb-0 block w-full" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png?w=1600&amp;h=840&amp;fit=crop&amp;crop=entropy&amp;auto=compress,format&amp;format=webp"/></noscript></span></div><div class="mt-6 break-words px-4 text-center font-heading text-3xl font-bold text-slate-900 dark:text-white md:mt-10 md:px-5 md:text-4xl lg:px-8 xl:px-20 xl:text-5xl mb-8 md:mb-14"><h1 class="leading-tight" data-query="post-title">Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)</h1></div><div class="relative z-20 mb-8 flex flex-row flex-wrap items-center justify-center px-4 md:-mt-7 md:mb-14 md:text-lg last:md:mb-10"><div class="mb-5 flex w-full flex-row items-center justify-center md:mb-0 md:w-auto md:justify-start"><div style="z-index:1" class="overflow-hidden rounded-full  bg-slate-200  dark:bg-white/20 md:mr-3 h-10 w-10 md:h-12 md:w-12"><a href="https://hashnode.com/@Phawazzzy" class="relative block h-full w-full"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27200%27%20height=%27200%27/%3e"/></span><img alt="Fawas Kareem&#x27;s photo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="relative z-20 block w-full rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Fawas Kareem&#x27;s photo" loading="lazy" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="relative z-20 block w-full rounded-full" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg?w=200&amp;h=200&amp;fit=crop&amp;crop=faces&amp;auto=compress,format&amp;format=webp"/></noscript></span></a></div><a href="https://hashnode.com/@Phawazzzy" class="ml-2 font-semibold text-slate-600 dark:text-white md:ml-0"><span>Fawas Kareem</span></a></div><div class="mb-5 flex w-full flex-row items-center justify-center md:mb-0 md:w-auto md:justify-start"><span class="mx-3 hidden font-bold text-slate-500 md:block">·</span><a href="https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz" class="tooltip-handle text-slate-600 dark:text-slate-400" data-title="Aug 15, 2020 13:47"><time dateTime="2020-08-15T13:47:17.576Z">Aug 15, 2020</time></a><span class="mx-3 block font-bold text-slate-500">·</span><p class="flex flex-row items-center text-slate-600 dark:text-slate-400"><svg class="mr-2 h-5 w-5 fill-current opacity-75" viewBox="0 0 576 512"><path d="M540.9 56.77c-45.95-16.66-90.23-24.09-129.1-24.75-60.7.94-102.7 17.45-123.8 27.72-21.1-10.27-64.1-26.8-123.2-27.74-40-.05-84.4 8.35-129.7 24.77C14.18 64.33 0 84.41 0 106.7v302.9c0 14.66 6.875 28.06 18.89 36.8 11.81 8.531 26.64 10.98 40.73 6.781 118.9-36.34 209.3 19.05 214.3 22.19C277.8 477.6 281.2 480 287.1 480c6.52 0 10.12-2.373 14.07-4.578 10.78-6.688 98.3-57.66 214.3-22.27 14.11 4.25 28.86 1.75 40.75-6.812C569.1 437.6 576 424.2 576 409.6V106.7c0-22.28-14.2-42.35-35.1-49.93zM272 438.1c-24.95-12.03-71.01-29.37-130.5-29.37-27.83 0-58.5 3.812-91.19 13.77-4.406 1.344-9 .594-12.69-2.047C34.02 417.8 32 413.1 32 409.6V106.7c0-8.859 5.562-16.83 13.86-19.83C87.66 71.7 127.9 63.95 164.5 64c51.8.81 89.7 15.26 107.5 23.66V438.1zm272-28.5c0 4.375-2.016 8.234-5.594 10.84-3.766 2.703-8.297 3.422-12.69 2.125C424.1 391.6 341.3 420.4 304 438.3V87.66c17.8-8.4 55.7-22.85 107.4-23.66 35.31-.063 76.34 7.484 118.8 22.88 8.2 3 13.8 10.96 13.8 19.82v302.9z"></path></svg><span>6<!-- --> min read</span></p></div></div></div></div><div class="blog-content-wrapper article-main-wrapper container relative z-30 mx-auto grid grid-flow-row grid-cols-8 xl:gap-6 2xl:grid-cols-10"><section class="blog-content-main z-20 col-span-8 mb-10 px-4 md:z-10 lg:col-span-6 lg:col-start-2 lg:px-0 xl:col-span-6 xl:col-start-2 2xl:col-span-6 2xl:col-start-3"><div class="relative"><div id="post-content-parent" class="relative mb-10 pb-14"><div id="post-content-wrapper" class="prose prose-lg mx-auto mb-10 min-h-30 break-words dark:prose-dark xl:prose-xl"><p>Currently, I am working on an  <a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a>  using node js, express, and PostgresSQL, <a href="https://sequelize.org/">sequelize</a>  as the  <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a>.
writing an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.</p>
<p>I picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.
The best way I could think of is to use query parameters attached in the endpoints URL e.g  <a href="https://api.work.com/resource?createdDate=1992&amp;status=activated">(https://api.work.com/resource?createdDate=1992&amp;status=activated).</a> </p>
<p>But then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.</p>
<p>Enough of the talks and let's get down to the real deal. </p>
<p>It is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.</p>
<p>This method is designed to work with sequelize and mongoose.</p>
<p>Getting/fetching data from the database is the most used query while working with a database.</p>
<p>we mostly fetch data using find method in mongoose and findAll in sequelize.</p>
<pre><code>collection.<span class="hljs-built_in">find</span>()
</code></pre><p>The above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.
A very good example is the endpoint mentioned above.</p>
<p><a href="https://api.work.com/resource?createdDate=1992&amp;status=activated">(https://api.work.com/resource?createdDate=1992&amp;status=activated).</a> </p>
<p>This URL makes a get request to the <em>resource</em> endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. </p>
<p>This endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.</p>
<p>for mongoose with MongoDB, the query should look like this</p>
<pre><code><span class="hljs-selector-tag">collection</span><span class="hljs-selector-class">.find</span>({<span class="hljs-attribute">createdDate</span>: req.query.createdDate, status: req.query.status});
</code></pre><p>for sequelize with Postgres, the query should look like this</p>
<pre><code><span class="hljs-selector-tag">model</span><span class="hljs-selector-class">.findAll</span>({ <span class="hljs-attribute">where</span>: { createdDate: req.query.createdDate, status: req.query.status } });
</code></pre><p>I love my code to always look beautiful, so this can also be writing as</p>
<pre><code><span class="hljs-keyword">const</span> { createdDate, status } = req.query;

collection.find({ createdDate: createdDate, status: status });


and

model.findAll({
  <span class="hljs-keyword">where</span>:
  {
    createdDate: createdDate,
    status: status
  }
});
</code></pre><p>Now that we have seen how to query for data using both mongoose and sequelize codes, let's move on.</p>
<p>The above code works fine and smooth, but it has a limitation.
Did you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.</p>
<p>The limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this</p>
<p><a href="https://api.work.com/resource?createdDate=1992&amp;status=activated">(https://api.work.com/resource?createdDate=1992&amp;status=activated&amp;expired=false).</a> </p>
<p>quickly take a look at the code snippet above, there isn't provision for <em>expire</em>. </p>
<p>Here comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.</p>
<p>we want to create provision for all the filters that can be done on our data in the database. </p>
<p>P.S<em> This approach is still dependent on your data in the database.</em></p>
<p>The flow</p>
<ul>
<li>Gets all the possible query parameter from the URL</li>
<li>check if a query is present in the URL </li>
<li>if yes write the query code for the ORM you are working with</li>
</ul>
<p>Assume that we want to get data by filtering using Founded, Type and  region,  based on the below table</p>
<p>There might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png?auto=compress,format&format=webp" /></p>
<p>This helper function can accept any filter coming in.
let's follow the flow
first we create a function called query</p>
<pre><code><span class="hljs-keyword">const</span> { Op } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"sequelize"</span>)

<span class="hljs-keyword">const</span> query = <span class="hljs-function">(<span class="hljs-params">query</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> Query = {};
<span class="hljs-comment">//get all possible filters from the URL</span>
  <span class="hljs-keyword">const</span> { Type, dateRange, region } = query;
  <span class="hljs-keyword">if</span> (Type != <span class="hljs-literal">null</span>) Query.Type = Type
  <span class="hljs-keyword">if</span> (dateRange != <span class="hljs-literal">null</span>) Query.Founded = { [Op.gte]: dateRange }
  <span class="hljs-keyword">if</span> (region != <span class="hljs-literal">null</span> || region != <span class="hljs-literal">undefined</span>) Query.Region = region
  <span class="hljs-keyword">return</span> Query;
}
</code></pre><p>Note!!!
     The above function was written for the sequelize ORM</p>
<ul>
<li><p>the query function receives an argument which is an object of the query parameters from the URL</p>
</li>
<li><p>checks if any of the filters are not null before writing the DB query</p>
</li>
</ul>
<p>It is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively</p>
<p>Now let's make use of the query function</p>
<pre><code><span class="hljs-comment">//call the function </span>
  <span class="hljs-keyword">const</span> dbQuery = query(req.query);
<span class="hljs-comment">// it receives the arguement req.query from the URL</span>

<span class="hljs-comment">// lets inject the query function</span>
model.findAll({ <span class="hljs-keyword">where</span>: dbQuery });

<span class="hljs-comment">// incase of mongoose we have</span>
collection.find(dbQuery);
</code></pre><p>with this approach, any number of filter should work provided there is provision for it in the helper function.</p>
<p><img loading="lazy" src="https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png?auto=compress,format&format=webp" /></p>
<p>All the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.</p>
<p>This is how it works.
write the query for all possible filters, then check if a filter is added, then append the filter to the Query object.</p>
<p>code at a glance</p>
<pre><code>
<span class="hljs-keyword">const</span> { Op } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"sequelize"</span>)

<span class="hljs-comment">// function</span>
<span class="hljs-keyword">const</span> query = <span class="hljs-function">(<span class="hljs-params">query</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> Query = {};
<span class="hljs-comment">//get all possible filters from the URL</span>
  <span class="hljs-keyword">const</span> { Type, dateRange, region } = query;
  <span class="hljs-keyword">if</span> (Type != <span class="hljs-literal">null</span>) Query.Type = Type
  <span class="hljs-keyword">if</span> (dateRange != <span class="hljs-literal">null</span>) Query.Founded = { [Op.gte]: dateRange }
  <span class="hljs-keyword">if</span> (region != <span class="hljs-literal">null</span> || region != <span class="hljs-literal">undefined</span>) Query.Region = region
  <span class="hljs-keyword">return</span> Query;
}

<span class="hljs-comment">//call the function </span>
  <span class="hljs-keyword">const</span> dbQuery = query(req.query);
<span class="hljs-comment">// it receives the arguement req.query from the URL</span>

<span class="hljs-comment">// lets inject the query function</span>
model.findAll({ where: dbQuery });

<span class="hljs-comment">// incase of mongoose we have</span>
collection.find(dbQuery);
</code></pre><p>Thank you for reading.
I am thinking of writing an NPM package for this. I should make it more generic</p>
<p>Useful resources</p>
<p> <a href="https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/">learn node js</a> </p>
<p> <a href="https://mongoosejs.com/docs/queries.html">mongoose ODM</a> </p>
<p> <a href="https://sequelize.org/">sequelize ORM</a> </p>
<p>you can reach out to me on twitter in case you see a mistake I am open to correction.</p>
<p>twitter:   <a href="https://twitter.com/fawas_ola">https://twitter.com/fawas_ola</a> </p>
<p>github:  <a href="https://github.com/phawazzzy">https://github.com/phawazzzy</a> </p>
</div></div><div class="mb-5 flex w-full flex-row flex-wrap justify-center md:mb-0"><a class="mb-3 mr-3 rounded-lg border bg-slate-100 px-2 py-1 text-base font-medium text-slate-700 hover:bg-slate-200 dark:border-slate-800 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700" href="/tag/nodejs?source=tags_bottom_blogs"><span>Node.js</span></a><a class="mb-3 mr-3 rounded-lg border bg-slate-100 px-2 py-1 text-base font-medium text-slate-700 hover:bg-slate-200 dark:border-slate-800 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700" href="/tag/postgresql?source=tags_bottom_blogs"><span>PostgreSQL</span></a><a class="mb-3 mr-3 rounded-lg border bg-slate-100 px-2 py-1 text-base font-medium text-slate-700 hover:bg-slate-200 dark:border-slate-800 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700" href="/tag/mongoose?source=tags_bottom_blogs"><span>mongoose</span></a><a class="mb-3 mr-3 rounded-lg border bg-slate-100 px-2 py-1 text-base font-medium text-slate-700 hover:bg-slate-200 dark:border-slate-800 dark:bg-slate-800 dark:text-slate-100 dark:hover:bg-slate-700" href="/tag/rest-api?source=tags_bottom_blogs"><span>REST API</span></a></div></div></section></div><div class="container relative z-20 mx-auto grid grid-flow-row grid-cols-8 xl:gap-6 2xl:grid-cols-10"><div class="blog-comments-section-wrapper col-span-8 px-4 lg:col-span-6 lg:col-start-2 lg:px-0 xl:col-span-6 xl:col-start-2 2xl:col-span-6 2xl:col-start-3"></div></div></article></main></div></div></div><script type="text/javascript">
              var SUPPORTS_PASSIVE = false;
              try {
                var opts = Object.defineProperty({}, 'passive', {
                  get: function() {
                    SUPPORTS_PASSIVE = true;
                  }
                });
                window.addEventListener("testPassive", null, opts);
                window.removeEventListener("testPassive", null, opts);
              } catch (e) {}
            </script><script type="text/javascript">
              // Array.prototype.flat polyfill
              if (!Array.prototype.flat) {
                // eslint-disable-next-line no-extend-native
                Object.defineProperty(Array.prototype, 'flat', {
                  configurable: true,
                  writable: true,
                  value() {
                    // eslint-disable-next-line prefer-rest-params
                    const depth = typeof arguments[0] === 'undefined' ? 1 : Number(arguments[0]) || 0;
                    const result = [];
                    const { forEach } = result;

                    // eslint-disable-next-line no-var
                    var flatDeep = function (arr, depth) {
                      forEach.call(arr, (val) => {
                        if (depth > 0 && Array.isArray(val)) {
                          flatDeep(val, depth - 1);
                        } else {
                          result.push(val);
                        }
                      });
                    };

                    flatDeep(this, depth);
                    return result;
                  },
                });
              }
            </script><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":"{\"_id\":\"5f37e7650801bf3f76e5f562\",\"partOfPublication\":true,\"author\":{\"_id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"photo\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"username\":\"Phawazzzy\",\"bio\":\"\",\"socialMedia\":{\"website\":\"\",\"github\":\"\",\"twitter\":\"\",\"facebook\":\"\",\"stackoverflow\":\"\"},\"isDeactivated\":false},\"bookmarkedIn\":[],\"publication\":{\"_id\":\"5ee9029189a644767917507e\",\"author\":{\"_id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"photo\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"username\":\"Phawazzzy\"},\"badgePageEnabled\":false,\"description\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"domain\":\"\",\"domainStatus\":{},\"wwwPrefixedDomainStatus\":{},\"customCSSEnabled\":false,\"customCSSPublished\":{\"homeMin\":\"\",\"postMin\":\"\",\"staticMin\":\"\"},\"customRules\":[],\"darkModeLogo\":\"\",\"disableFooterBranding\":false,\"isSubscriptionModalDisabled\":false,\"displayTitle\":\"\",\"favicon\":\"\",\"gaTrackingID\":\"\",\"hasBadges\":true,\"headerColor\":\"\",\"hideMembersPage\":true,\"isTeam\":false,\"layout\":\"magazine\",\"menu\":[],\"metaHTML\":\"\u003cp\u003eSoftware developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \u003c/p\u003e\\n\",\"metaHTMLSanitized\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"newsletterEnabled\":true,\"newsletterPageEnabled\":false,\"ogImage\":\"\",\"logo\":\"\",\"textSelectionSharerEnabled\":false,\"title\":\"Fawas Tech Blog\",\"urlPattern\":\"\",\"username\":\"fawaskareem\",\"viewCountVisible\":false,\"readTimeHidden\":false,\"links\":{\"twitter\":\"https://twitter.com/@fawas_ola\",\"instagram\":\"\",\"github\":\"https://github.com/phawazzzy\",\"website\":\"https://github.com/phawazzzy\",\"hashnode\":\"https://hashnode.com/@Phawazzzy\",\"youtube\":\"\",\"dailydev\":\"\",\"linkedin\":\"\",\"mastodon\":\"\"},\"numPosts\":9,\"sponsorship\":{\"content\":\"\",\"contentMarkdown\":\"\"},\"allowContributorEdits\":true},\"tags\":[{\"_id\":\"56744722958ef13879b94ffb\",\"slug\":\"nodejs\",\"name\":\"Node.js\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56744721958ef13879b949b5\",\"slug\":\"postgresql\",\"name\":\"PostgreSQL\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56744723958ef13879b9540c\",\"slug\":\"mongoose\",\"name\":\"mongoose\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56b1208d04f0061506b360ff\",\"slug\":\"rest-api\",\"name\":\"REST API\",\"isActive\":true,\"isApproved\":true}],\"coAuthors\":[],\"responseCount\":1,\"replyCount\":1,\"contentMarkdown\":\"Currently, I am working on an  [API](https://en.wikipedia.org/wiki/Application_programming_interface)  using node js, express, and PostgresSQL, [sequelize](https://sequelize.org/)  as the  [ORM](https://en.wikipedia.org/wiki/Object-relational_mapping).\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\n\\nI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  [(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\\n\\nEnough of the talks and let's get down to the real deal. \\n\\nIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\\n\\nThis method is designed to work with sequelize and mongoose.\\n\\nGetting/fetching data from the database is the most used query while working with a database.\\n\\nwe mostly fetch data using find method in mongoose and findAll in sequelize.\\n\\n\\n```\\ncollection.find()\\n``` \\nThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nThis URL makes a get request to the *resource* endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \\n\\nThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\\n\\nfor mongoose with MongoDB, the query should look like this\\n\\n```\\ncollection.find({createdDate: req.query.createdDate, status: req.query.status});\\n``` \\nfor sequelize with Postgres, the query should look like this\\n\\n```\\nmodel.findAll({ where: { createdDate: req.query.createdDate, status: req.query.status } });\\n``` \\nI love my code to always look beautiful, so this can also be writing as\\n\\n\\n```\\nconst { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  where:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\\n\\n``` \\nNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\\n\\nThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\\n\\nThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated\u0026expired=false).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nquickly take a look at the code snippet above, there isn't provision for *expire*. \\n\\nHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\\n\\nwe want to create provision for all the filters that can be done on our data in the database. \\n\\nP.S* This approach is still dependent on your data in the database.*\\n\\nThe flow\\n\\n- Gets all the possible query parameter from the URL\\n- check if a query is present in the URL \\n- if yes write the query code for the ORM you are working with\\n\\nAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\\n\\nThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\\n\\n![Screenshot from 2020-08-15 13-17-46.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png)\\n\\n\\nThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\\n\\n\\n```\\nconst { Op } = require(\\\"sequelize\\\")\\n\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n``` \\nNote!!!\\n     The above function was written for the sequelize ORM\\n\\n- the query function receives an argument which is an object of the query parameters from the URL\\n\\n- checks if any of the filters are not null before writing the DB query\\n\\nIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\\n\\nNow let's make use of the query function\\n\\n\\n```\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n``` \\n\\n\\n\\nwith this approach, any number of filter should work provided there is provision for it in the helper function.\\n\\n\\n\\n![Screenshot from 2020-08-15 14-28-10.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png)\\n\\nAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\\n\\nThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\\n\\ncode at a glance\\n\\n\\n```\\n\\nconst { Op } = require(\\\"sequelize\\\")\\n\\n// function\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n\\n``` \\n\\nThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\\n\\n\\nUseful resources\\n\\n [learn node js](https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/) \\n\\n [mongoose ODM](https://mongoosejs.com/docs/queries.html) \\n\\n [sequelize ORM](https://sequelize.org/) \\n\\n\\nyou can reach out to me on twitter in case you see a mistake I am open to correction.\\n\\ntwitter:   [https://twitter.com/fawas_ola](https://twitter.com/fawas_ola) \\n\\ngithub:  [https://github.com/phawazzzy](https://github.com/phawazzzy) \\n\\n\\n\\n\\n\\n\\n\\n \\n\\n\\n\\n\\n\",\"content\":\"\u003cp\u003eCurrently, I am working on an  \u003ca href=\\\"https://en.wikipedia.org/wiki/Application_programming_interface\\\"\u003eAPI\u003c/a\u003e  using node js, express, and PostgresSQL, \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize\u003c/a\u003e  as the  \u003ca href=\\\"https://en.wikipedia.org/wiki/Object-relational_mapping\\\"\u003eORM\u003c/a\u003e.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\u003c/p\u003e\\n\u003cp\u003eI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  \u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\u003c/p\u003e\\n\u003cp\u003eEnough of the talks and let's get down to the real deal. \u003c/p\u003e\\n\u003cp\u003eIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\u003c/p\u003e\\n\u003cp\u003eThis method is designed to work with sequelize and mongoose.\u003c/p\u003e\\n\u003cp\u003eGetting/fetching data from the database is the most used query while working with a database.\u003c/p\u003e\\n\u003cp\u003ewe mostly fetch data using find method in mongoose and findAll in sequelize.\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003ecollection.\u003cspan class=\\\"hljs-built_in\\\"\u003efind\u003c/span\u003e()\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eThis URL makes a get request to the \u003cem\u003eresource\u003c/em\u003e endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \u003c/p\u003e\\n\u003cp\u003eThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\u003c/p\u003e\\n\u003cp\u003efor mongoose with MongoDB, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003ecollection\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.find\u003c/span\u003e({\u003cspan class=\\\"hljs-attribute\\\"\u003ecreatedDate\u003c/span\u003e: req.query.createdDate, status: req.query.status});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003efor sequelize with Postgres, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003emodel\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.findAll\u003c/span\u003e({ \u003cspan class=\\\"hljs-attribute\\\"\u003ewhere\u003c/span\u003e: { createdDate: req.query.createdDate, status: req.query.status } });\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eI love my code to always look beautiful, so this can also be writing as\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\u003c/p\u003e\\n\u003cp\u003eThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\u003c/p\u003e\\n\u003cp\u003eThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\u0026amp;expired=false).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003equickly take a look at the code snippet above, there isn't provision for \u003cem\u003eexpire\u003c/em\u003e. \u003c/p\u003e\\n\u003cp\u003eHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\u003c/p\u003e\\n\u003cp\u003ewe want to create provision for all the filters that can be done on our data in the database. \u003c/p\u003e\\n\u003cp\u003eP.S\u003cem\u003e This approach is still dependent on your data in the database.\u003c/em\u003e\u003c/p\u003e\\n\u003cp\u003eThe flow\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003eGets all the possible query parameter from the URL\u003c/li\u003e\\n\u003cli\u003echeck if a query is present in the URL \u003c/li\u003e\\n\u003cli\u003eif yes write the query code for the ORM you are working with\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\u003c/p\u003e\\n\u003cp\u003eThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote!!!\\n     The above function was written for the sequelize ORM\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003cp\u003ethe query function receives an argument which is an object of the query parameters from the URL\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003cp\u003echecks if any of the filters are not null before writing the DB query\u003c/p\u003e\\n\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\u003c/p\u003e\\n\u003cp\u003eNow let's make use of the query function\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewith this approach, any number of filter should work provided there is provision for it in the helper function.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\u003c/p\u003e\\n\u003cp\u003eThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\u003c/p\u003e\\n\u003cp\u003ecode at a glance\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// function\u003c/span\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ where: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\u003c/p\u003e\\n\u003cp\u003eUseful resources\u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/\\\"\u003elearn node js\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://mongoosejs.com/docs/queries.html\\\"\u003emongoose ODM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize ORM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eyou can reach out to me on twitter in case you see a mistake I am open to correction.\u003c/p\u003e\\n\u003cp\u003etwitter:   \u003ca href=\\\"https://twitter.com/fawas_ola\\\"\u003ehttps://twitter.com/fawas_ola\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003egithub:  \u003ca href=\\\"https://github.com/phawazzzy\\\"\u003ehttps://github.com/phawazzzy\u003c/a\u003e \u003c/p\u003e\\n\",\"cuid\":\"ckdvpssom01dyjas16gan67cz\",\"views\":754,\"title\":\"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)\",\"slug\":\"writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose\",\"dateAdded\":\"2020-08-15T13:47:17.576Z\",\"dateUpdated\":\"2020-08-16T16:52:37.855Z\",\"type\":\"story\",\"coverImage\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png\",\"isCoverImagePortrait\":false,\"isCoverAttributionHidden\":false,\"brief\":\"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\nI picked the tickets to work on fo...\",\"isFollowing\":false,\"totalReactions\":0,\"totalReactionsByCurrentUser\":0,\"series\":null,\"isPinnedToBlog\":false,\"readTime\":6,\"sB\":false,\"isAMA\":false,\"subtitle\":\"\",\"isPartOfSeries\":false,\"hasTags\":true,\"ogImage\":\"\",\"metaTitle\":\"\",\"metaDescription\":\"\",\"isRepublished\":false,\"autoPublishedFromRSS\":false,\"responses\":[],\"isFeatured\":false,\"hasLatex\":false,\"stickCoverToBottom\":false,\"hideBadges\":false,\"badges\":[],\"isDelisted\":false,\"audioUrls\":{},\"disableComments\":false,\"enableToc\":false,\"toc\":[],\"noIndex\":false}","publication":"{\"__typename\":\"Publication\",\"id\":\"5ee9029189a644767917507e\",\"url\":\"https://fawaskareem.hashnode.dev\",\"canonicalURL\":\"https://fawaskareem.hashnode.dev\",\"urlPattern\":\"DEFAULT\",\"title\":\"Fawas Tech Blog\",\"displayTitle\":\"\",\"hasBadges\":true,\"descriptionSEO\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"about\":{\"html\":\"\u003cp\u003eSoftware developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \u003c/p\u003e\\n\",\"text\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\"},\"features\":{\"newsletter\":{\"isEnabled\":true},\"viewCount\":{\"isEnabled\":false},\"readTime\":{\"isEnabled\":true},\"textSelectionSharer\":{\"isEnabled\":false},\"customCSS\":{\"isEnabled\":false,\"published\":null,\"draft\":null}},\"metaTags\":null,\"ogMetaData\":{\"image\":null},\"author\":{\"__typename\":\"User\",\"id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"username\":\"Phawazzzy\",\"profilePicture\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\"},\"preferences\":{\"__typename\":\"Preferences\",\"logo\":null,\"darkMode\":{\"__typename\":\"DarkModePreferences\",\"logo\":null,\"enabled\":null},\"navbarItems\":[],\"enabledPages\":{\"__typename\":\"PagesPreferences\",\"badges\":true,\"newsletter\":true,\"members\":null},\"layout\":null,\"disableFooterBranding\":false,\"isSubscriptionModalDisabled\":false},\"favicon\":null,\"headerColor\":null,\"integrations\":{\"fbPixelID\":null,\"fathomSiteID\":null,\"fathomCustomDomainEnabled\":null,\"fathomCustomDomain\":null,\"hotjarSiteID\":null,\"matomoSiteID\":null,\"matomoURL\":null,\"gaTrackingID\":null,\"plausibleAnalyticsEnabled\":null,\"wmPaymentPointer\":null},\"imprintV2\":null,\"postsCount\":{\"totalDocuments\":9},\"isTeam\":false,\"links\":{\"twitter\":\"https://twitter.com/@fawas_ola\",\"instagram\":null,\"github\":\"https://github.com/phawazzzy\",\"website\":\"https://github.com/phawazzzy\",\"hashnode\":\"https://hashnode.com/@Phawazzzy\",\"youtube\":\"\",\"dailydev\":null,\"linkedin\":null,\"mastodon\":null},\"domainInfo\":{\"__typename\":\"DomainInfo\",\"hashnodeSubdomain\":\"fawaskareem\",\"domain\":null,\"wwwPrefixedDomain\":null},\"redirectionRules\":[],\"totalRecommendedPublications\":0,\"sponsorship\":{\"content\":null,\"stripe\":null},\"pro\":null,\"allowContributorEdits\":true,\"rssImport\":null,\"post\":{\"id\":\"5f37e7650801bf3f76e5f562\",\"cuid\":\"ckdvpssom01dyjas16gan67cz\",\"title\":\"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)\",\"subtitle\":null,\"slug\":\"writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose\",\"brief\":\"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\nI picked the tickets to work on fo...\",\"featured\":false,\"publishedAt\":\"2020-08-15T13:47:17.576Z\",\"updatedAt\":\"2020-08-16T16:52:37.855Z\",\"author\":{\"__typename\":\"User\",\"id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"username\":\"Phawazzzy\",\"deactivated\":false,\"profilePicture\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"isPro\":false,\"bio\":{\"html\":\"\"},\"socialMediaLinks\":{\"website\":\"\",\"github\":\"\",\"twitter\":\"\",\"facebook\":\"\",\"stackoverflow\":\"\",\"linkedin\":null}},\"coAuthors\":[],\"seo\":{\"title\":null,\"description\":null,\"shouldNotIndex\":false},\"coverImage\":{\"url\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png\",\"isPortrait\":false,\"attribution\":null,\"isAttributionHidden\":false,\"photographer\":null},\"responseCount\":1,\"reactionCount\":0,\"replyCount\":1,\"content\":{\"html\":\"\u003cp\u003eCurrently, I am working on an  \u003ca href=\\\"https://en.wikipedia.org/wiki/Application_programming_interface\\\"\u003eAPI\u003c/a\u003e  using node js, express, and PostgresSQL, \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize\u003c/a\u003e  as the  \u003ca href=\\\"https://en.wikipedia.org/wiki/Object-relational_mapping\\\"\u003eORM\u003c/a\u003e.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\u003c/p\u003e\\n\u003cp\u003eI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  \u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\u003c/p\u003e\\n\u003cp\u003eEnough of the talks and let's get down to the real deal. \u003c/p\u003e\\n\u003cp\u003eIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\u003c/p\u003e\\n\u003cp\u003eThis method is designed to work with sequelize and mongoose.\u003c/p\u003e\\n\u003cp\u003eGetting/fetching data from the database is the most used query while working with a database.\u003c/p\u003e\\n\u003cp\u003ewe mostly fetch data using find method in mongoose and findAll in sequelize.\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003ecollection.\u003cspan class=\\\"hljs-built_in\\\"\u003efind\u003c/span\u003e()\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eThis URL makes a get request to the \u003cem\u003eresource\u003c/em\u003e endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \u003c/p\u003e\\n\u003cp\u003eThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\u003c/p\u003e\\n\u003cp\u003efor mongoose with MongoDB, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003ecollection\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.find\u003c/span\u003e({\u003cspan class=\\\"hljs-attribute\\\"\u003ecreatedDate\u003c/span\u003e: req.query.createdDate, status: req.query.status});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003efor sequelize with Postgres, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003emodel\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.findAll\u003c/span\u003e({ \u003cspan class=\\\"hljs-attribute\\\"\u003ewhere\u003c/span\u003e: { createdDate: req.query.createdDate, status: req.query.status } });\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eI love my code to always look beautiful, so this can also be writing as\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\u003c/p\u003e\\n\u003cp\u003eThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\u003c/p\u003e\\n\u003cp\u003eThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\u0026amp;expired=false).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003equickly take a look at the code snippet above, there isn't provision for \u003cem\u003eexpire\u003c/em\u003e. \u003c/p\u003e\\n\u003cp\u003eHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\u003c/p\u003e\\n\u003cp\u003ewe want to create provision for all the filters that can be done on our data in the database. \u003c/p\u003e\\n\u003cp\u003eP.S\u003cem\u003e This approach is still dependent on your data in the database.\u003c/em\u003e\u003c/p\u003e\\n\u003cp\u003eThe flow\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003eGets all the possible query parameter from the URL\u003c/li\u003e\\n\u003cli\u003echeck if a query is present in the URL \u003c/li\u003e\\n\u003cli\u003eif yes write the query code for the ORM you are working with\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\u003c/p\u003e\\n\u003cp\u003eThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote!!!\\n     The above function was written for the sequelize ORM\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003cp\u003ethe query function receives an argument which is an object of the query parameters from the URL\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003cp\u003echecks if any of the filters are not null before writing the DB query\u003c/p\u003e\\n\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\u003c/p\u003e\\n\u003cp\u003eNow let's make use of the query function\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewith this approach, any number of filter should work provided there is provision for it in the helper function.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\u003c/p\u003e\\n\u003cp\u003eThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\u003c/p\u003e\\n\u003cp\u003ecode at a glance\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// function\u003c/span\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ where: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\u003c/p\u003e\\n\u003cp\u003eUseful resources\u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/\\\"\u003elearn node js\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://mongoosejs.com/docs/queries.html\\\"\u003emongoose ODM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize ORM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eyou can reach out to me on twitter in case you see a mistake I am open to correction.\u003c/p\u003e\\n\u003cp\u003etwitter:   \u003ca href=\\\"https://twitter.com/fawas_ola\\\"\u003ehttps://twitter.com/fawas_ola\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003egithub:  \u003ca href=\\\"https://github.com/phawazzzy\\\"\u003ehttps://github.com/phawazzzy\u003c/a\u003e \u003c/p\u003e\\n\",\"markdown\":\"Currently, I am working on an  [API](https://en.wikipedia.org/wiki/Application_programming_interface)  using node js, express, and PostgresSQL, [sequelize](https://sequelize.org/)  as the  [ORM](https://en.wikipedia.org/wiki/Object-relational_mapping).\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\n\\nI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  [(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\\n\\nEnough of the talks and let's get down to the real deal. \\n\\nIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\\n\\nThis method is designed to work with sequelize and mongoose.\\n\\nGetting/fetching data from the database is the most used query while working with a database.\\n\\nwe mostly fetch data using find method in mongoose and findAll in sequelize.\\n\\n\\n```\\ncollection.find()\\n``` \\nThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nThis URL makes a get request to the *resource* endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \\n\\nThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\\n\\nfor mongoose with MongoDB, the query should look like this\\n\\n```\\ncollection.find({createdDate: req.query.createdDate, status: req.query.status});\\n``` \\nfor sequelize with Postgres, the query should look like this\\n\\n```\\nmodel.findAll({ where: { createdDate: req.query.createdDate, status: req.query.status } });\\n``` \\nI love my code to always look beautiful, so this can also be writing as\\n\\n\\n```\\nconst { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  where:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\\n\\n``` \\nNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\\n\\nThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\\n\\nThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated\u0026expired=false).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nquickly take a look at the code snippet above, there isn't provision for *expire*. \\n\\nHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\\n\\nwe want to create provision for all the filters that can be done on our data in the database. \\n\\nP.S* This approach is still dependent on your data in the database.*\\n\\nThe flow\\n\\n- Gets all the possible query parameter from the URL\\n- check if a query is present in the URL \\n- if yes write the query code for the ORM you are working with\\n\\nAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\\n\\nThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\\n\\n![Screenshot from 2020-08-15 13-17-46.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png)\\n\\n\\nThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\\n\\n\\n```\\nconst { Op } = require(\\\"sequelize\\\")\\n\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n``` \\nNote!!!\\n     The above function was written for the sequelize ORM\\n\\n- the query function receives an argument which is an object of the query parameters from the URL\\n\\n- checks if any of the filters are not null before writing the DB query\\n\\nIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\\n\\nNow let's make use of the query function\\n\\n\\n```\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n``` \\n\\n\\n\\nwith this approach, any number of filter should work provided there is provision for it in the helper function.\\n\\n\\n\\n![Screenshot from 2020-08-15 14-28-10.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png)\\n\\nAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\\n\\nThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\\n\\ncode at a glance\\n\\n\\n```\\n\\nconst { Op } = require(\\\"sequelize\\\")\\n\\n// function\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n\\n``` \\n\\nThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\\n\\n\\nUseful resources\\n\\n [learn node js](https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/) \\n\\n [mongoose ODM](https://mongoosejs.com/docs/queries.html) \\n\\n [sequelize ORM](https://sequelize.org/) \\n\\n\\nyou can reach out to me on twitter in case you see a mistake I am open to correction.\\n\\ntwitter:   [https://twitter.com/fawas_ola](https://twitter.com/fawas_ola) \\n\\ngithub:  [https://github.com/phawazzzy](https://github.com/phawazzzy) \\n\\n\\n\\n\\n\\n\\n\\n \\n\\n\\n\\n\\n\"},\"views\":754,\"preferences\":{\"pinnedToBlog\":false,\"disableComments\":false,\"stickCoverToBottom\":false,\"isDelisted\":false},\"readTimeInMinutes\":6,\"series\":null,\"tags\":[{\"id\":\"56744722958ef13879b94ffb\",\"slug\":\"nodejs\",\"name\":\"Node.js\"},{\"id\":\"56744721958ef13879b949b5\",\"slug\":\"postgresql\",\"name\":\"PostgreSQL\"},{\"id\":\"56744723958ef13879b9540c\",\"slug\":\"mongoose\",\"name\":\"mongoose\"},{\"id\":\"56b1208d04f0061506b360ff\",\"slug\":\"rest-api\",\"name\":\"REST API\"}],\"ogMetaData\":{\"image\":null},\"canonicalUrl\":null,\"hasLatexInPost\":false,\"audioUrls\":null,\"isFollowed\":null,\"bookmarked\":false,\"features\":{\"tableOfContents\":{\"isEnabled\":false,\"items\":[]},\"badges\":{\"isEnabled\":true,\"items\":[]}},\"isAutoPublishedFromRSS\":false,\"authenticatedUserLikes\":{\"edges\":[]},\"totalUserLikes\":{\"totalDocuments\":0},\"isShadowBanned\":false,\"isAskMeAnything\":false},\"redirectedPost\":null,\"staticPage\":null}","totalUsersWhoLikedArticle":0,"integrations":{"fbPixelID":null,"fathomSiteID":null,"fathomCustomDomainEnabled":null,"fathomCustomDomain":null,"hotjarSiteID":null,"matomoSiteID":null,"matomoURL":null,"gaTrackingID":null,"plausibleAnalyticsEnabled":null,"domainURL":"fawaskareem.hashnode.dev"},"rootLayout":{"legacyPublicationJSON":"{\"_id\":\"5ee9029189a644767917507e\",\"author\":{\"_id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"photo\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"username\":\"Phawazzzy\"},\"badgePageEnabled\":false,\"description\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"domain\":\"\",\"domainStatus\":{},\"wwwPrefixedDomainStatus\":{},\"customCSSEnabled\":false,\"customCSSPublished\":{\"homeMin\":\"\",\"postMin\":\"\",\"staticMin\":\"\"},\"customRules\":[],\"darkModeLogo\":\"\",\"disableFooterBranding\":false,\"isSubscriptionModalDisabled\":false,\"displayTitle\":\"\",\"favicon\":\"\",\"gaTrackingID\":\"\",\"hasBadges\":true,\"headerColor\":\"\",\"hideMembersPage\":true,\"isTeam\":false,\"layout\":\"magazine\",\"menu\":[],\"metaHTML\":\"\u003cp\u003eSoftware developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \u003c/p\u003e\\n\",\"metaHTMLSanitized\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"newsletterEnabled\":true,\"newsletterPageEnabled\":false,\"ogImage\":\"\",\"logo\":\"\",\"textSelectionSharerEnabled\":false,\"title\":\"Fawas Tech Blog\",\"urlPattern\":\"\",\"username\":\"fawaskareem\",\"viewCountVisible\":false,\"readTimeHidden\":false,\"links\":{\"twitter\":\"https://twitter.com/@fawas_ola\",\"instagram\":\"\",\"github\":\"https://github.com/phawazzzy\",\"website\":\"https://github.com/phawazzzy\",\"hashnode\":\"https://hashnode.com/@Phawazzzy\",\"youtube\":\"\",\"dailydev\":\"\",\"linkedin\":\"\",\"mastodon\":\"\"},\"numPosts\":9,\"sponsorship\":{\"content\":\"\",\"contentMarkdown\":\"\"},\"allowContributorEdits\":true}","legacyPostJSON":"{\"_id\":\"5f37e7650801bf3f76e5f562\",\"partOfPublication\":true,\"author\":{\"_id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"photo\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"username\":\"Phawazzzy\",\"bio\":\"\",\"socialMedia\":{\"website\":\"\",\"github\":\"\",\"twitter\":\"\",\"facebook\":\"\",\"stackoverflow\":\"\"},\"isDeactivated\":false},\"bookmarkedIn\":[],\"publication\":{\"_id\":\"5ee9029189a644767917507e\",\"author\":{\"_id\":\"5d74dba9912e5cfd222c86c0\",\"name\":\"Fawas Kareem\",\"photo\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg\",\"username\":\"Phawazzzy\"},\"badgePageEnabled\":false,\"description\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"domain\":\"\",\"domainStatus\":{},\"wwwPrefixedDomainStatus\":{},\"customCSSEnabled\":false,\"customCSSPublished\":{\"homeMin\":\"\",\"postMin\":\"\",\"staticMin\":\"\"},\"customRules\":[],\"darkModeLogo\":\"\",\"disableFooterBranding\":false,\"isSubscriptionModalDisabled\":false,\"displayTitle\":\"\",\"favicon\":\"\",\"gaTrackingID\":\"\",\"hasBadges\":true,\"headerColor\":\"\",\"hideMembersPage\":true,\"isTeam\":false,\"layout\":\"magazine\",\"menu\":[],\"metaHTML\":\"\u003cp\u003eSoftware developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \u003c/p\u003e\\n\",\"metaHTMLSanitized\":\"Software developer fascinated by anything backend related.\\nLove flutter framework, which makes me a mobile developer also. \\n\",\"newsletterEnabled\":true,\"newsletterPageEnabled\":false,\"ogImage\":\"\",\"logo\":\"\",\"textSelectionSharerEnabled\":false,\"title\":\"Fawas Tech Blog\",\"urlPattern\":\"\",\"username\":\"fawaskareem\",\"viewCountVisible\":false,\"readTimeHidden\":false,\"links\":{\"twitter\":\"https://twitter.com/@fawas_ola\",\"instagram\":\"\",\"github\":\"https://github.com/phawazzzy\",\"website\":\"https://github.com/phawazzzy\",\"hashnode\":\"https://hashnode.com/@Phawazzzy\",\"youtube\":\"\",\"dailydev\":\"\",\"linkedin\":\"\",\"mastodon\":\"\"},\"numPosts\":9,\"sponsorship\":{\"content\":\"\",\"contentMarkdown\":\"\"},\"allowContributorEdits\":true},\"tags\":[{\"_id\":\"56744722958ef13879b94ffb\",\"slug\":\"nodejs\",\"name\":\"Node.js\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56744721958ef13879b949b5\",\"slug\":\"postgresql\",\"name\":\"PostgreSQL\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56744723958ef13879b9540c\",\"slug\":\"mongoose\",\"name\":\"mongoose\",\"isActive\":true,\"isApproved\":true},{\"_id\":\"56b1208d04f0061506b360ff\",\"slug\":\"rest-api\",\"name\":\"REST API\",\"isActive\":true,\"isApproved\":true}],\"coAuthors\":[],\"responseCount\":1,\"replyCount\":1,\"contentMarkdown\":\"Currently, I am working on an  [API](https://en.wikipedia.org/wiki/Application_programming_interface)  using node js, express, and PostgresSQL, [sequelize](https://sequelize.org/)  as the  [ORM](https://en.wikipedia.org/wiki/Object-relational_mapping).\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\n\\nI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  [(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\\n\\nEnough of the talks and let's get down to the real deal. \\n\\nIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\\n\\nThis method is designed to work with sequelize and mongoose.\\n\\nGetting/fetching data from the database is the most used query while working with a database.\\n\\nwe mostly fetch data using find method in mongoose and findAll in sequelize.\\n\\n\\n```\\ncollection.find()\\n``` \\nThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nThis URL makes a get request to the *resource* endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \\n\\nThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\\n\\nfor mongoose with MongoDB, the query should look like this\\n\\n```\\ncollection.find({createdDate: req.query.createdDate, status: req.query.status});\\n``` \\nfor sequelize with Postgres, the query should look like this\\n\\n```\\nmodel.findAll({ where: { createdDate: req.query.createdDate, status: req.query.status } });\\n``` \\nI love my code to always look beautiful, so this can also be writing as\\n\\n\\n```\\nconst { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  where:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\\n\\n``` \\nNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\\n\\nThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\\n\\nThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\\n\\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated\u0026expired=false).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \\n\\nquickly take a look at the code snippet above, there isn't provision for *expire*. \\n\\nHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\\n\\nwe want to create provision for all the filters that can be done on our data in the database. \\n\\nP.S* This approach is still dependent on your data in the database.*\\n\\nThe flow\\n\\n- Gets all the possible query parameter from the URL\\n- check if a query is present in the URL \\n- if yes write the query code for the ORM you are working with\\n\\nAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\\n\\nThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\\n\\n![Screenshot from 2020-08-15 13-17-46.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png)\\n\\n\\nThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\\n\\n\\n```\\nconst { Op } = require(\\\"sequelize\\\")\\n\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n``` \\nNote!!!\\n     The above function was written for the sequelize ORM\\n\\n- the query function receives an argument which is an object of the query parameters from the URL\\n\\n- checks if any of the filters are not null before writing the DB query\\n\\nIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\\n\\nNow let's make use of the query function\\n\\n\\n```\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n``` \\n\\n\\n\\nwith this approach, any number of filter should work provided there is provision for it in the helper function.\\n\\n\\n\\n![Screenshot from 2020-08-15 14-28-10.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png)\\n\\nAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\\n\\nThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\\n\\ncode at a glance\\n\\n\\n```\\n\\nconst { Op } = require(\\\"sequelize\\\")\\n\\n// function\\nconst query = (query) =\u003e {\\n  let Query = {};\\n//get all possible filters from the URL\\n  const { Type, dateRange, region } = query;\\n  if (Type != null) Query.Type = Type\\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\\n  if (region != null || region != undefined) Query.Region = region\\n  return Query;\\n}\\n\\n//call the function \\n  const dbQuery = query(req.query);\\n// it receives the arguement req.query from the URL\\n\\n// lets inject the query function\\nmodel.findAll({ where: dbQuery });\\n\\n// incase of mongoose we have\\ncollection.find(dbQuery);\\n\\n\\n``` \\n\\nThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\\n\\n\\nUseful resources\\n\\n [learn node js](https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/) \\n\\n [mongoose ODM](https://mongoosejs.com/docs/queries.html) \\n\\n [sequelize ORM](https://sequelize.org/) \\n\\n\\nyou can reach out to me on twitter in case you see a mistake I am open to correction.\\n\\ntwitter:   [https://twitter.com/fawas_ola](https://twitter.com/fawas_ola) \\n\\ngithub:  [https://github.com/phawazzzy](https://github.com/phawazzzy) \\n\\n\\n\\n\\n\\n\\n\\n \\n\\n\\n\\n\\n\",\"content\":\"\u003cp\u003eCurrently, I am working on an  \u003ca href=\\\"https://en.wikipedia.org/wiki/Application_programming_interface\\\"\u003eAPI\u003c/a\u003e  using node js, express, and PostgresSQL, \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize\u003c/a\u003e  as the  \u003ca href=\\\"https://en.wikipedia.org/wiki/Object-relational_mapping\\\"\u003eORM\u003c/a\u003e.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\u003c/p\u003e\\n\u003cp\u003eI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  \u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\u003c/p\u003e\\n\u003cp\u003eEnough of the talks and let's get down to the real deal. \u003c/p\u003e\\n\u003cp\u003eIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\u003c/p\u003e\\n\u003cp\u003eThis method is designed to work with sequelize and mongoose.\u003c/p\u003e\\n\u003cp\u003eGetting/fetching data from the database is the most used query while working with a database.\u003c/p\u003e\\n\u003cp\u003ewe mostly fetch data using find method in mongoose and findAll in sequelize.\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003ecollection.\u003cspan class=\\\"hljs-built_in\\\"\u003efind\u003c/span\u003e()\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\\nA very good example is the endpoint mentioned above.\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eThis URL makes a get request to the \u003cem\u003eresource\u003c/em\u003e endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \u003c/p\u003e\\n\u003cp\u003eThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\u003c/p\u003e\\n\u003cp\u003efor mongoose with MongoDB, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003ecollection\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.find\u003c/span\u003e({\u003cspan class=\\\"hljs-attribute\\\"\u003ecreatedDate\u003c/span\u003e: req.query.createdDate, status: req.query.status});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003efor sequelize with Postgres, the query should look like this\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-selector-tag\\\"\u003emodel\u003c/span\u003e\u003cspan class=\\\"hljs-selector-class\\\"\u003e.findAll\u003c/span\u003e({ \u003cspan class=\\\"hljs-attribute\\\"\u003ewhere\u003c/span\u003e: { createdDate: req.query.createdDate, status: req.query.status } });\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eI love my code to always look beautiful, so this can also be writing as\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { createdDate, status } = req.query;\\n\\ncollection.find({ createdDate: createdDate, status: status });\\n\\n\\nand\\n\\nmodel.findAll({\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e:\\n  {\\n    createdDate: createdDate,\\n    status: status\\n  }\\n});\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\u003c/p\u003e\\n\u003cp\u003eThe above code works fine and smooth, but it has a limitation.\\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\u003c/p\u003e\\n\u003cp\u003eThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\u003c/p\u003e\\n\u003cp\u003e\u003ca href=\\\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\\\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\u0026amp;expired=false).\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003equickly take a look at the code snippet above, there isn't provision for \u003cem\u003eexpire\u003c/em\u003e. \u003c/p\u003e\\n\u003cp\u003eHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\u003c/p\u003e\\n\u003cp\u003ewe want to create provision for all the filters that can be done on our data in the database. \u003c/p\u003e\\n\u003cp\u003eP.S\u003cem\u003e This approach is still dependent on your data in the database.\u003c/em\u003e\u003c/p\u003e\\n\u003cp\u003eThe flow\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003eGets all the possible query parameter from the URL\u003c/li\u003e\\n\u003cli\u003echeck if a query is present in the URL \u003c/li\u003e\\n\u003cli\u003eif yes write the query code for the ORM you are working with\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\u003c/p\u003e\\n\u003cp\u003eThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eThis helper function can accept any filter coming in.\\nlet's follow the flow\\nfirst we create a function called query\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote!!!\\n     The above function was written for the sequelize ORM\u003c/p\u003e\\n\u003cul\u003e\\n\u003cli\u003e\u003cp\u003ethe query function receives an argument which is an object of the query parameters from the URL\u003c/p\u003e\\n\u003c/li\u003e\\n\u003cli\u003e\u003cp\u003echecks if any of the filters are not null before writing the DB query\u003c/p\u003e\\n\u003c/li\u003e\\n\u003c/ul\u003e\\n\u003cp\u003eIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\u003c/p\u003e\\n\u003cp\u003eNow let's make use of the query function\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ \u003cspan class=\\\"hljs-keyword\\\"\u003ewhere\u003c/span\u003e: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewith this approach, any number of filter should work provided there is provision for it in the helper function.\u003c/p\u003e\\n\u003cp\u003e\u003cimg src=\\\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png\\\" /\u003e\u003c/p\u003e\\n\u003cp\u003eAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\u003c/p\u003e\\n\u003cp\u003eThis is how it works.\\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\u003c/p\u003e\\n\u003cp\u003ecode at a glance\u003c/p\u003e\\n\u003cpre\u003e\u003ccode\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\\\"hljs-built_in\\\"\u003erequire\u003c/span\u003e(\u003cspan class=\\\"hljs-string\\\"\u003e\\\"sequelize\\\"\u003c/span\u003e)\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// function\u003c/span\u003e\\n\u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e query = \u003cspan class=\\\"hljs-function\\\"\u003e(\u003cspan class=\\\"hljs-params\\\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003elet\u003c/span\u003e Query = {};\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//get all possible filters from the URL\u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Type = Type\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003eif\u003c/span\u003e (region != \u003cspan class=\\\"hljs-literal\\\"\u003enull\u003c/span\u003e || region != \u003cspan class=\\\"hljs-literal\\\"\u003eundefined\u003c/span\u003e) Query.Region = region\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003ereturn\u003c/span\u003e Query;\\n}\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e//call the function \u003c/span\u003e\\n  \u003cspan class=\\\"hljs-keyword\\\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// lets inject the query function\u003c/span\u003e\\nmodel.findAll({ where: dbQuery });\\n\\n\u003cspan class=\\\"hljs-comment\\\"\u003e// incase of mongoose we have\u003c/span\u003e\\ncollection.find(dbQuery);\\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThank you for reading.\\nI am thinking of writing an NPM package for this. I should make it more generic\u003c/p\u003e\\n\u003cp\u003eUseful resources\u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/\\\"\u003elearn node js\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://mongoosejs.com/docs/queries.html\\\"\u003emongoose ODM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003e \u003ca href=\\\"https://sequelize.org/\\\"\u003esequelize ORM\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003eyou can reach out to me on twitter in case you see a mistake I am open to correction.\u003c/p\u003e\\n\u003cp\u003etwitter:   \u003ca href=\\\"https://twitter.com/fawas_ola\\\"\u003ehttps://twitter.com/fawas_ola\u003c/a\u003e \u003c/p\u003e\\n\u003cp\u003egithub:  \u003ca href=\\\"https://github.com/phawazzzy\\\"\u003ehttps://github.com/phawazzzy\u003c/a\u003e \u003c/p\u003e\\n\",\"cuid\":\"ckdvpssom01dyjas16gan67cz\",\"views\":754,\"title\":\"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)\",\"slug\":\"writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose\",\"dateAdded\":\"2020-08-15T13:47:17.576Z\",\"dateUpdated\":\"2020-08-16T16:52:37.855Z\",\"type\":\"story\",\"coverImage\":\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png\",\"isCoverImagePortrait\":false,\"isCoverAttributionHidden\":false,\"brief\":\"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\\nI picked the tickets to work on fo...\",\"isFollowing\":false,\"totalReactions\":0,\"totalReactionsByCurrentUser\":0,\"series\":null,\"isPinnedToBlog\":false,\"readTime\":6,\"sB\":false,\"isAMA\":false,\"subtitle\":\"\",\"isPartOfSeries\":false,\"hasTags\":true,\"ogImage\":\"\",\"metaTitle\":\"\",\"metaDescription\":\"\",\"isRepublished\":false,\"autoPublishedFromRSS\":false,\"responses\":[],\"isFeatured\":false,\"hasLatex\":false,\"stickCoverToBottom\":false,\"hideBadges\":false,\"badges\":[],\"isDelisted\":false,\"audioUrls\":{},\"disableComments\":false,\"enableToc\":false,\"toc\":[],\"noIndex\":false}","legacySeriesJSON":null,"headProps":{"title":"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)","description":"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\nI picked the tickets to work on fo...","author":{"name":"Fawas Kareem","username":"Phawazzzy"},"links":[{"rel":"canonical","href":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz"}],"pageType":"article","bannerType":"large","ogSiteName":"Fawas Tech Blog","url":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz","ogImage":"https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1597498125763%2FwDrH2aIEy.png%3Fw%3D1200%26h%3D630%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp%26fm%3Dpng","twitterImage":"https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1597498125763%2FwDrH2aIEy.png%3Fw%3D1200%26h%3D630%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp%26fm%3Dpng","twitterHandle":"","monetization":null,"style":{},"customHeadItems":{"customFavicon":null,"customTheme":null,"customMeta":null},"hljs":true},"isDarkTheme":false,"headerColor":null,"isBadge":null,"isRecommendations":null,"isHome":null,"currentMenuId":null,"hnmcMode":false,"postCUID":"ckdvpssom01dyjas16gan67cz","seoSchema":{"@context":"https://schema.org","@type":"NewsArticle","url":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz","mainEntityOfPage":"https://fawaskareem.hashnode.dev/writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz","headline":"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)","description":"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\nI picked the tickets to work on fo...","datePublished":"2020-08-15T13:47:17.576Z","dateModified":"2020-08-16T16:52:37.855Z","isAccessibleForFree":true,"author":{"@type":"Person","name":"Fawas Kareem","url":"https://hashnode.com/@Phawazzzy"},"publisher":{"@type":"Organization","name":"Fawas Tech Blog","url":"https://fawaskareem.hashnode.dev","logo":"https://hashnode.com/utility/r?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1559814205701%2Fek9fO-yT0.jpeg%3Fw%3D800%26bm%3Dnormal%26balph%3D100%26txt64%3DRmF3YXMgVGVjaCBCbG9n%26txtsize%3D42%26txtfit%3Dmax%26txtalign%3Dmiddle%2Ccenter%26txtfont%3DHelvetica%20Neue%2CBold%26txtclr%3D000000%26blend%3Dffffff"},"image":{"@type":"ImageObject","url":"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png"}},"publication":{"__typename":"Publication","id":"5ee9029189a644767917507e","url":"https://fawaskareem.hashnode.dev","canonicalURL":"https://fawaskareem.hashnode.dev","urlPattern":"DEFAULT","title":"Fawas Tech Blog","displayTitle":"","hasBadges":true,"descriptionSEO":"Software developer fascinated by anything backend related.\nLove flutter framework, which makes me a mobile developer also. \n","about":{"html":"\u003cp\u003eSoftware developer fascinated by anything backend related.\nLove flutter framework, which makes me a mobile developer also. \u003c/p\u003e\n","text":"Software developer fascinated by anything backend related.\nLove flutter framework, which makes me a mobile developer also. \n"},"features":{"newsletter":{"isEnabled":true},"viewCount":{"isEnabled":false},"readTime":{"isEnabled":true},"textSelectionSharer":{"isEnabled":false},"customCSS":{"isEnabled":false,"published":null,"draft":null}},"metaTags":null,"ogMetaData":{"image":null},"author":{"__typename":"User","id":"5d74dba9912e5cfd222c86c0","name":"Fawas Kareem","username":"Phawazzzy","profilePicture":"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg"},"preferences":{"__typename":"Preferences","logo":null,"darkMode":{"__typename":"DarkModePreferences","logo":null,"enabled":null},"navbarItems":[],"enabledPages":{"__typename":"PagesPreferences","badges":true,"newsletter":true,"members":null},"layout":null,"disableFooterBranding":false,"isSubscriptionModalDisabled":false},"favicon":null,"headerColor":null,"integrations":{"fbPixelID":null,"fathomSiteID":null,"fathomCustomDomainEnabled":null,"fathomCustomDomain":null,"hotjarSiteID":null,"matomoSiteID":null,"matomoURL":null,"gaTrackingID":null,"plausibleAnalyticsEnabled":null},"imprintV2":null,"postsCount":{"totalDocuments":9},"isTeam":false,"links":{"twitter":"https://twitter.com/@fawas_ola","instagram":null,"github":"https://github.com/phawazzzy","website":"https://github.com/phawazzzy","hashnode":"https://hashnode.com/@Phawazzzy","youtube":"","dailydev":null,"linkedin":null,"mastodon":null},"domainInfo":{"__typename":"DomainInfo","hashnodeSubdomain":"fawaskareem","domain":null,"wwwPrefixedDomain":null},"redirectionRules":[],"totalRecommendedPublications":0,"sponsorship":{"content":null,"stripe":null},"pro":null,"allowContributorEdits":true,"rssImport":null,"post":{"id":"5f37e7650801bf3f76e5f562","cuid":"ckdvpssom01dyjas16gan67cz","title":"Writing a generic helper function for handling query parameters in node js(sequelize and mongoose)","subtitle":null,"slug":"writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose","brief":"Currently, I am working on an  API  using node js, express, and PostgresSQL, sequelize  as the  ORM.\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\nI picked the tickets to work on fo...","featured":false,"publishedAt":"2020-08-15T13:47:17.576Z","updatedAt":"2020-08-16T16:52:37.855Z","author":{"__typename":"User","id":"5d74dba9912e5cfd222c86c0","name":"Fawas Kareem","username":"Phawazzzy","deactivated":false,"profilePicture":"https://cdn.hashnode.com/res/hashnode/image/upload/v1567939498408/ECLUAvVrl.jpeg","isPro":false,"bio":{"html":""},"socialMediaLinks":{"website":"","github":"","twitter":"","facebook":"","stackoverflow":"","linkedin":null}},"coAuthors":[],"seo":{"title":null,"description":null,"shouldNotIndex":false},"coverImage":{"url":"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498125763/wDrH2aIEy.png","isPortrait":false,"attribution":null,"isAttributionHidden":false,"photographer":null},"responseCount":1,"reactionCount":0,"replyCount":1,"content":{"html":"\u003cp\u003eCurrently, I am working on an  \u003ca href=\"https://en.wikipedia.org/wiki/Application_programming_interface\"\u003eAPI\u003c/a\u003e  using node js, express, and PostgresSQL, \u003ca href=\"https://sequelize.org/\"\u003esequelize\u003c/a\u003e  as the  \u003ca href=\"https://en.wikipedia.org/wiki/Object-relational_mapping\"\u003eORM\u003c/a\u003e.\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\u003c/p\u003e\n\u003cp\u003eI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  \u003ca href=\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003eBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\u003c/p\u003e\n\u003cp\u003eEnough of the talks and let's get down to the real deal. \u003c/p\u003e\n\u003cp\u003eIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\u003c/p\u003e\n\u003cp\u003eThis method is designed to work with sequelize and mongoose.\u003c/p\u003e\n\u003cp\u003eGetting/fetching data from the database is the most used query while working with a database.\u003c/p\u003e\n\u003cp\u003ewe mostly fetch data using find method in mongoose and findAll in sequelize.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecollection.\u003cspan class=\"hljs-built_in\"\u003efind\u003c/span\u003e()\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\nA very good example is the endpoint mentioned above.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated).\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003eThis URL makes a get request to the \u003cem\u003eresource\u003c/em\u003e endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \u003c/p\u003e\n\u003cp\u003eThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\u003c/p\u003e\n\u003cp\u003efor mongoose with MongoDB, the query should look like this\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-selector-tag\"\u003ecollection\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.find\u003c/span\u003e({\u003cspan class=\"hljs-attribute\"\u003ecreatedDate\u003c/span\u003e: req.query.createdDate, status: req.query.status});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003efor sequelize with Postgres, the query should look like this\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-selector-tag\"\u003emodel\u003c/span\u003e\u003cspan class=\"hljs-selector-class\"\u003e.findAll\u003c/span\u003e({ \u003cspan class=\"hljs-attribute\"\u003ewhere\u003c/span\u003e: { createdDate: req.query.createdDate, status: req.query.status } });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eI love my code to always look beautiful, so this can also be writing as\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { createdDate, status } = req.query;\n\ncollection.find({ createdDate: createdDate, status: status });\n\n\nand\n\nmodel.findAll({\n  \u003cspan class=\"hljs-keyword\"\u003ewhere\u003c/span\u003e:\n  {\n    createdDate: createdDate,\n    status: status\n  }\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\u003c/p\u003e\n\u003cp\u003eThe above code works fine and smooth, but it has a limitation.\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\u003c/p\u003e\n\u003cp\u003eThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\"\u003e(https://api.work.com/resource?createdDate=1992\u0026amp;status=activated\u0026amp;expired=false).\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003equickly take a look at the code snippet above, there isn't provision for \u003cem\u003eexpire\u003c/em\u003e. \u003c/p\u003e\n\u003cp\u003eHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\u003c/p\u003e\n\u003cp\u003ewe want to create provision for all the filters that can be done on our data in the database. \u003c/p\u003e\n\u003cp\u003eP.S\u003cem\u003e This approach is still dependent on your data in the database.\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003eThe flow\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eGets all the possible query parameter from the URL\u003c/li\u003e\n\u003cli\u003echeck if a query is present in the URL \u003c/li\u003e\n\u003cli\u003eif yes write the query code for the ORM you are working with\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\u003c/p\u003e\n\u003cp\u003eThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png\" /\u003e\u003c/p\u003e\n\u003cp\u003eThis helper function can accept any filter coming in.\nlet's follow the flow\nfirst we create a function called query\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"sequelize\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e query = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e Query = {};\n\u003cspan class=\"hljs-comment\"\u003e//get all possible filters from the URL\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e) Query.Type = Type\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (region != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e || region != \u003cspan class=\"hljs-literal\"\u003eundefined\u003c/span\u003e) Query.Region = region\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Query;\n}\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote!!!\n     The above function was written for the sequelize ORM\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003ethe query function receives an argument which is an object of the query parameters from the URL\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003echecks if any of the filters are not null before writing the DB query\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\u003c/p\u003e\n\u003cp\u003eNow let's make use of the query function\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-comment\"\u003e//call the function \u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\n\u003cspan class=\"hljs-comment\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// lets inject the query function\u003c/span\u003e\nmodel.findAll({ \u003cspan class=\"hljs-keyword\"\u003ewhere\u003c/span\u003e: dbQuery });\n\n\u003cspan class=\"hljs-comment\"\u003e// incase of mongoose we have\u003c/span\u003e\ncollection.find(dbQuery);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ewith this approach, any number of filter should work provided there is provision for it in the helper function.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png\" /\u003e\u003c/p\u003e\n\u003cp\u003eAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\u003c/p\u003e\n\u003cp\u003eThis is how it works.\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\u003c/p\u003e\n\u003cp\u003ecode at a glance\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { Op } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"sequelize\"\u003c/span\u003e)\n\n\u003cspan class=\"hljs-comment\"\u003e// function\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e query = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003equery\u003c/span\u003e) =\u0026gt;\u003c/span\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e Query = {};\n\u003cspan class=\"hljs-comment\"\u003e//get all possible filters from the URL\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { Type, dateRange, region } = query;\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (Type != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e) Query.Type = Type\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (dateRange != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e) Query.Founded = { [Op.gte]: dateRange }\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (region != \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e || region != \u003cspan class=\"hljs-literal\"\u003eundefined\u003c/span\u003e) Query.Region = region\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Query;\n}\n\n\u003cspan class=\"hljs-comment\"\u003e//call the function \u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dbQuery = query(req.query);\n\u003cspan class=\"hljs-comment\"\u003e// it receives the arguement req.query from the URL\u003c/span\u003e\n\n\u003cspan class=\"hljs-comment\"\u003e// lets inject the query function\u003c/span\u003e\nmodel.findAll({ where: dbQuery });\n\n\u003cspan class=\"hljs-comment\"\u003e// incase of mongoose we have\u003c/span\u003e\ncollection.find(dbQuery);\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThank you for reading.\nI am thinking of writing an NPM package for this. I should make it more generic\u003c/p\u003e\n\u003cp\u003eUseful resources\u003c/p\u003e\n\u003cp\u003e \u003ca href=\"https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/\"\u003elearn node js\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003e \u003ca href=\"https://mongoosejs.com/docs/queries.html\"\u003emongoose ODM\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003e \u003ca href=\"https://sequelize.org/\"\u003esequelize ORM\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003eyou can reach out to me on twitter in case you see a mistake I am open to correction.\u003c/p\u003e\n\u003cp\u003etwitter:   \u003ca href=\"https://twitter.com/fawas_ola\"\u003ehttps://twitter.com/fawas_ola\u003c/a\u003e \u003c/p\u003e\n\u003cp\u003egithub:  \u003ca href=\"https://github.com/phawazzzy\"\u003ehttps://github.com/phawazzzy\u003c/a\u003e \u003c/p\u003e\n","markdown":"Currently, I am working on an  [API](https://en.wikipedia.org/wiki/Application_programming_interface)  using node js, express, and PostgresSQL, [sequelize](https://sequelize.org/)  as the  [ORM](https://en.wikipedia.org/wiki/Object-relational_mapping).\nwriting an API that will be consumed by other people needs to be written in a way that caters to everyone's needs.\n\nI picked the tickets to work on for the week,  the ticket description is to write an API endpoint that gets data from the database based on filters.\nThe best way I could think of is to use query parameters attached in the endpoints URL e.g  [(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \n\nBut then, I needed to write simple and less code to achieve this, I am one of the lazy programmers 😃, so I was looking for a way to write a function or something that can cater for any filters, regardless of the number of filters which will come in as a query parameter. After a few hours of thinking, I came up with a helper function.\n\nEnough of the talks and let's get down to the real deal. \n\nIt is expected that you have prior knowledge of writing API with node js, and sequelize or mongoose as this article won't touch those parts.\n\nThis method is designed to work with sequelize and mongoose.\n\nGetting/fetching data from the database is the most used query while working with a database.\n\nwe mostly fetch data using find method in mongoose and findAll in sequelize.\n\n\n```\ncollection.find()\n``` \nThe above code will fetch all the data in the database collection or table, but sometimes we would not need all the data from a collection, sometimes we might want to search for something or get some set of data that falls under some certain conditions.\nA very good example is the endpoint mentioned above.\n\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \n\nThis URL makes a get request to the *resource* endpoint, there are other words attached to the URL we have createdDate and status, both are equal to 1992 and activated respectively. \n\nThis endpoint is expected to return all the data that their createdDate is 1992 and their status is activated. This can be achieved by writing some DB queries.\n\nfor mongoose with MongoDB, the query should look like this\n\n```\ncollection.find({createdDate: req.query.createdDate, status: req.query.status});\n``` \nfor sequelize with Postgres, the query should look like this\n\n```\nmodel.findAll({ where: { createdDate: req.query.createdDate, status: req.query.status } });\n``` \nI love my code to always look beautiful, so this can also be writing as\n\n\n```\nconst { createdDate, status } = req.query;\n\ncollection.find({ createdDate: createdDate, status: status });\n\n\nand\n\nmodel.findAll({\n  where:\n  {\n    createdDate: createdDate,\n    status: status\n  }\n});\n\n\n``` \nNow that we have seen how to query for data using both mongoose and sequelize codes, let's move on.\n\nThe above code works fine and smooth, but it has a limitation.\nDid you guess the limitation🤔? if no, let's talk about it and I hope you will agree with me.\n\nThe limitation is that this endpoint and the code can only cater for the two query parameters, what if the user consuming the API needs to add another query parameter to it, something like this\n\n[(https://api.work.com/resource?createdDate=1992\u0026status=activated\u0026expired=false).](https://api.work.com/resource?createdDate=1992\u0026status=activated) \n\nquickly take a look at the code snippet above, there isn't provision for *expire*. \n\nHere comes the approach to fix the limitation as at the time of writing this article, it can also be improved. I will be glad to see the improved version of it.\n\nwe want to create provision for all the filters that can be done on our data in the database. \n\nP.S* This approach is still dependent on your data in the database.*\n\nThe flow\n\n- Gets all the possible query parameter from the URL\n- check if a query is present in the URL \n- if yes write the query code for the ORM you are working with\n\nAssume that we want to get data by filtering using Founded, Type and  region,  based on the below table\n\nThere might be a scenario where the user consuming the API wants to get only the data based on the Founded, Type, and region.\n\n![Screenshot from 2020-08-15 13-17-46.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597493900821/MYuWyx3fF.png)\n\n\nThis helper function can accept any filter coming in.\nlet's follow the flow\nfirst we create a function called query\n\n\n```\nconst { Op } = require(\"sequelize\")\n\nconst query = (query) =\u003e {\n  let Query = {};\n//get all possible filters from the URL\n  const { Type, dateRange, region } = query;\n  if (Type != null) Query.Type = Type\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\n  if (region != null || region != undefined) Query.Region = region\n  return Query;\n}\n``` \nNote!!!\n     The above function was written for the sequelize ORM\n\n- the query function receives an argument which is an object of the query parameters from the URL\n\n- checks if any of the filters are not null before writing the DB query\n\nIt is important to know how your schema or table is defined and how the fields are spelled because we would be sending the Query object into the find or findAll methods for mongoose and sequelize respectively\n\nNow let's make use of the query function\n\n\n```\n//call the function \n  const dbQuery = query(req.query);\n// it receives the arguement req.query from the URL\n\n// lets inject the query function\nmodel.findAll({ where: dbQuery });\n\n// incase of mongoose we have\ncollection.find(dbQuery);\n\n``` \n\n\n\nwith this approach, any number of filter should work provided there is provision for it in the helper function.\n\n\n\n![Screenshot from 2020-08-15 14-28-10.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1597498186128/-clgt5pON.png)\n\nAll the magic is happening in the query function, that is where you define and write the query for all possible filter that can be done on your data.\n\nThis is how it works.\nwrite the query for all possible filters, then check if a filter is added, then append the filter to the Query object.\n\ncode at a glance\n\n\n```\n\nconst { Op } = require(\"sequelize\")\n\n// function\nconst query = (query) =\u003e {\n  let Query = {};\n//get all possible filters from the URL\n  const { Type, dateRange, region } = query;\n  if (Type != null) Query.Type = Type\n  if (dateRange != null) Query.Founded = { [Op.gte]: dateRange }\n  if (region != null || region != undefined) Query.Region = region\n  return Query;\n}\n\n//call the function \n  const dbQuery = query(req.query);\n// it receives the arguement req.query from the URL\n\n// lets inject the query function\nmodel.findAll({ where: dbQuery });\n\n// incase of mongoose we have\ncollection.find(dbQuery);\n\n\n``` \n\nThank you for reading.\nI am thinking of writing an NPM package for this. I should make it more generic\n\n\nUseful resources\n\n [learn node js](https://docs.microsoft.com/en-gb/learn/paths/build-javascript-applications-nodejs/) \n\n [mongoose ODM](https://mongoosejs.com/docs/queries.html) \n\n [sequelize ORM](https://sequelize.org/) \n\n\nyou can reach out to me on twitter in case you see a mistake I am open to correction.\n\ntwitter:   [https://twitter.com/fawas_ola](https://twitter.com/fawas_ola) \n\ngithub:  [https://github.com/phawazzzy](https://github.com/phawazzzy) \n\n\n\n\n\n\n\n \n\n\n\n\n"},"views":754,"preferences":{"pinnedToBlog":false,"disableComments":false,"stickCoverToBottom":false,"isDelisted":false},"readTimeInMinutes":6,"series":null,"tags":[{"id":"56744722958ef13879b94ffb","slug":"nodejs","name":"Node.js"},{"id":"56744721958ef13879b949b5","slug":"postgresql","name":"PostgreSQL"},{"id":"56744723958ef13879b9540c","slug":"mongoose","name":"mongoose"},{"id":"56b1208d04f0061506b360ff","slug":"rest-api","name":"REST API"}],"ogMetaData":{"image":null},"canonicalUrl":null,"hasLatexInPost":false,"audioUrls":null,"isFollowed":null,"bookmarked":false,"features":{"tableOfContents":{"isEnabled":false,"items":[]},"badges":{"isEnabled":true,"items":[]}},"isAutoPublishedFromRSS":false,"authenticatedUserLikes":{"edges":[]},"totalUserLikes":{"totalDocuments":0},"isShadowBanned":false,"isAskMeAnything":false},"redirectedPost":null,"staticPage":null},"series":null}},"__N_SSP":true},"page":"/[...slug]","query":{"slug":["writing-a-generic-helper-function-for-handling-query-parameters-in-node-jssequelize-and-mongoose-ckdvpssom01dyjas16gan67cz"]},"buildId":"Z3LCGys0VVvSnYg5jJZcd","isFallback":false,"dynamicIds":[87179],"gssp":true,"scriptLoader":[]}</script><div id="hn-modal"></div><div id="hn-toast"></div></body></html>